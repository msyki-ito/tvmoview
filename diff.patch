diff --git a/SYMBOLS.md b/SYMBOLS.md
index e90a5aff707d383a8becf3fc42df24ec0bf01928..c80fdaa45b10f6b16aa55733e90255d1e34b93e4 100644
--- a/SYMBOLS.md
+++ b/SYMBOLS.md
@@ -82,50 +82,51 @@
   - [F] getCurrentPath(folderId: String?): String
   - [F] getFolderItems(folderId: String): List<MediaItem>
   - [F] getRootItems(): List<MediaItem>
 
 ## com.example.tvmoview.data.repository
 - OneDriveRepository
   - [F] getCachedItems(folderId: String?): List<MediaItem>
   - [F] getCurrentPath(folderId: String?): String
   - [F] getDownloadUrl(itemId: String): String?
   - [F] getFolderItems(folderId: String? = null, force: Boolean = false): Flow<List<MediaItem>>
 
 ## com.example.tvmoview.domain.model
 - MediaItem
   - [P] downloadUrl: String?
   - [P] fileExtension: String
   - [P] formattedSize: String
   - [P] id: String,
   - [P] isFolder: Boolean
   - [P] isImage: Boolean
   - [P] isVideo: Boolean
   - [P] lastModified: Date
   - [P] mimeType: String?
   - [P] name: String,
   - [P] size: Long
   - [P] thumbnailUrl: String?
+  - [P] duration: Long
 
 ## com.example.tvmoview.presentation.screens
 - Authenticated
 
 ## com.example.tvmoview.presentation.screens
 - Checking
 
 ## com.example.tvmoview.presentation.screens
 - Error
 
 ## com.example.tvmoview.presentation.screens
 - GettingCode
 
 ## com.example.tvmoview.presentation.screens
 - NotAuthenticated
 
 ## com.example.tvmoview.presentation.screens
 - Ready
 
 ## com.example.tvmoview.presentation.screens
 - ShowingCode
 
 ## com.example.tvmoview.presentation.screens
 - Success
 
@@ -146,26 +147,33 @@
 - FireTVOptimizations
   - [F] initializeForFireTV(activity: Activity)
 
 ## com.example.tvmoview
 - Authenticated
 
 ## com.example.tvmoview
 - Checking
 
 ## com.example.tvmoview
 - ExampleInstrumentedTest
   - [F] useAppContext()
 
 ## com.example.tvmoview
 - ExampleUnitTest
   - [F] addition_isCorrect()
 
 ## com.example.tvmoview
 - MainActivity
   - [F] AuthenticationWrapper()
 
 ## com.example.tvmoview
 - NotAuthenticated
   - [F] AppNavigation()
 
+## com.example.tvmoview.data.prefs
+- UserPreferences
+  - [F] init(context: Context)
+  - [P] sortBy: String
+  - [P] sortOrder: String
+  - [P] tileColumns: Int
+
 
diff --git a/app/build.gradle.kts b/app/build.gradle.kts
index 787813cee9366ff330d7ff1455a5a904c5f8d634..2427a5762508a437cc09c35d8173454c0a77c523 100644
--- a/app/build.gradle.kts
+++ b/app/build.gradle.kts
@@ -1,31 +1,30 @@
 plugins {
     id("com.android.application")
     id("org.jetbrains.kotlin.android")
     id("org.jetbrains.kotlin.plugin.compose") version "2.0.0"
-    // âœ… kapt ãƒ—ãƒ©ã‚°ã‚¤ãƒ³è¿½åŠ 
-    id("org.jetbrains.kotlin.kapt")
+    id("com.google.devtools.ksp")
 }
 
 android {
     namespace = "com.example.tvmoview"
     compileSdk = 34
 
     defaultConfig {
         applicationId = "com.example.tvmoview"
         minSdk = 26
         targetSdk = 34
         versionCode = 1
         versionName = "1.0"
 
         testInstrumentationRunner = "androidx.test.runner.AndroidJUnitRunner"
         vectorDrawables {
             useSupportLibrary = true
         }
     }
 
     buildTypes {
         release {
             isMinifyEnabled = false
             proguardFiles(
                 getDefaultProguardFile("proguard-android-optimize.txt"),
                 "proguard-rules.pro"
@@ -33,78 +32,78 @@ android {
         }
     }
 
     compileOptions {
         sourceCompatibility = JavaVersion.VERSION_1_8
         targetCompatibility = JavaVersion.VERSION_1_8
     }
 
     kotlinOptions {
         jvmTarget = "1.8"
     }
 
     buildFeatures {
         compose = true
     }
 
     packaging {
         resources {
             excludes += "/META-INF/{AL2.0,LGPL2.1}"
         }
     }
 }
 
 dependencies {
     // Core Android
-    implementation("androidx.core:core-ktx:1.12.0")
-    implementation("androidx.lifecycle:lifecycle-runtime-ktx:2.7.0")
-    implementation("androidx.activity:activity-compose:1.8.2")
+    implementation(libs.androidx.core.ktx)
+    implementation(libs.androidx.lifecycle.runtime.ktx)
+    implementation(libs.androidx.activity.compose)
 
     // Compose BOM
-    implementation(platform("androidx.compose:compose-bom:2024.02.00"))
-    implementation("androidx.compose.ui:ui")
-    implementation("androidx.compose.ui:ui-graphics")
-    implementation("androidx.compose.ui:ui-tooling-preview")
-    implementation("androidx.compose.material3:material3")
+    implementation(platform(libs.androidx.compose.bom))
+    implementation(libs.androidx.ui)
+    implementation(libs.androidx.ui.graphics)
+    implementation(libs.androidx.ui.tooling.preview)
+    implementation(libs.androidx.material3)
     implementation("androidx.compose.material:material-icons-extended")
 
     // Navigation
-    implementation("androidx.navigation:navigation-compose:2.7.6")
+    implementation(libs.androidx.navigation.compose)
 
     // ViewModel
     implementation("androidx.lifecycle:lifecycle-viewmodel-compose:2.7.0")
 
     // Coroutines
-    implementation("org.jetbrains.kotlinx:kotlinx-coroutines-android:1.7.3")
+    implementation(libs.kotlinx.coroutines.android)
 
     // TV Support
-    implementation("androidx.tv:tv-foundation:1.0.0-alpha10")
-    implementation("androidx.tv:tv-material:1.0.0-alpha10")
+    implementation(libs.androidx.tv.foundation)
+    implementation(libs.androidx.tv.material)
     implementation("androidx.leanback:leanback:1.0.0")
 
     // âœ… Media3 ExoPlayerï¼ˆå‹•ç”»å†ç”Ÿå¼·åŒ–ï¼‰
-    implementation("androidx.media3:media3-exoplayer:1.2.1")
-    implementation("androidx.media3:media3-ui:1.2.1")
-    implementation("androidx.media3:media3-common:1.2.1")
+    implementation(libs.androidx.media3.exoplayer)
+    implementation(libs.androidx.media3.ui)
+    implementation(libs.androidx.media3.common)
 
     // âœ… Image Loadingï¼ˆå°†æ¥ã®ç”»åƒãƒ“ãƒ¥ãƒ¼ã‚¢ç”¨ï¼‰
-    implementation("io.coil-kt:coil-compose:2.5.0")
-    implementation("io.coil-kt:coil:2.5.0")
+    implementation(libs.coil.compose)
+    implementation(libs.coil)
 
     // âœ… Room Databaseï¼ˆå°†æ¥ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ç”¨ï¼‰
-    implementation("androidx.room:room-runtime:2.6.1")
-    implementation("androidx.room:room-ktx:2.6.1")
-    kapt("androidx.room:room-compiler:2.6.1") // âœ… kaptä½¿ç”¨
+    implementation(libs.androidx.room.runtime)
+    implementation(libs.androidx.room.ktx)
+    ksp(libs.androidx.room.compiler)
 
     // HTTPé€šä¿¡ï¼ˆOneDrive APIï¼‰
-    implementation("com.squareup.okhttp3:okhttp:4.12.0")
-    implementation("com.squareup.retrofit2:retrofit:2.9.0")
-    implementation("com.squareup.retrofit2:converter-gson:2.9.0")
-    implementation("com.squareup.okhttp3:logging-interceptor:4.12.0")
+    implementation(libs.okhttp)
+    implementation(libs.retrofit)
+    implementation(libs.retrofit.converter.gson)
+    implementation(libs.okhttp.logging)
 
     // Security
     implementation("androidx.security:security-crypto:1.1.0-alpha06")
 
     // Debug
-    debugImplementation("androidx.compose.ui:ui-tooling")
-    debugImplementation("androidx.compose.ui:ui-test-manifest")
+    debugImplementation(libs.androidx.ui.tooling)
+    debugImplementation(libs.androidx.ui.test.manifest)
 }
\ No newline at end of file
diff --git a/app/build.gradle.kts.rej b/app/build.gradle.kts.rej
deleted file mode 100644
index aadc6aabb79941ffe0a7f5c57ffaca84570a7052..0000000000000000000000000000000000000000
--- a/app/build.gradle.kts.rej
+++ /dev/null
@@ -1,53 +0,0 @@
-diff a/app/build.gradle.kts b/app/build.gradle.kts	(rejected hunks)
-@@ -32,50 +32,51 @@ android {
-             )
-         }
-     }
- 
-     compileOptions {
-         sourceCompatibility = JavaVersion.VERSION_1_8
-         targetCompatibility = JavaVersion.VERSION_1_8
-     }
- 
-     kotlinOptions {
-         jvmTarget = "1.8"
-     }
- 
-     buildFeatures {
-         compose = true
-     }
- 
-     packaging {
-         resources {
-             excludes += "/META-INF/{AL2.0,LGPL2.1}"
-         }
-     }
- }
- 
- dependencies {
-+    // TODO: replace hardcoded versions with version catalog references
-     // Core Android
-     implementation("androidx.core:core-ktx:1.12.0")
-     implementation("androidx.lifecycle:lifecycle-runtime-ktx:2.7.0")
-     implementation("androidx.activity:activity-compose:1.8.2")
- 
-     // Compose BOM
-     implementation(platform("androidx.compose:compose-bom:2024.02.00"))
-     implementation("androidx.compose.ui:ui")
-     implementation("androidx.compose.ui:ui-graphics")
-     implementation("androidx.compose.ui:ui-tooling-preview")
-     implementation("androidx.compose.material3:material3")
-     implementation("androidx.compose.material:material-icons-extended")
- 
-     // Navigation
-     implementation("androidx.navigation:navigation-compose:2.7.6")
- 
-     // ViewModel
-     implementation("androidx.lifecycle:lifecycle-viewmodel-compose:2.7.0")
- 
-     // Coroutines
-     implementation("org.jetbrains.kotlinx:kotlinx-coroutines-android:1.7.3")
- 
-     // TV Support
-     implementation("androidx.tv:tv-foundation:1.0.0-alpha10")
-     implementation("androidx.tv:tv-material:1.0.0-alpha10")
diff --git a/app/src/main/java/com/example/tvmoview/MainActivity.kt b/app/src/main/java/com/example/tvmoview/MainActivity.kt
index 47b71b04d10c6bab60ba21f5a38764c7cba74e6a..114795ff6a19f6d9bfa03009ece13b6db2fd730f 100644
--- a/app/src/main/java/com/example/tvmoview/MainActivity.kt
+++ b/app/src/main/java/com/example/tvmoview/MainActivity.kt
@@ -1,72 +1,75 @@
 ï»¿package com.example.tvmoview
 
 import android.content.Intent
 import android.os.Bundle
 import android.util.Log
 import androidx.activity.ComponentActivity
 import androidx.activity.compose.setContent
 import androidx.compose.foundation.layout.*
 import androidx.compose.material3.*
 import androidx.compose.runtime.*
 import androidx.compose.ui.Alignment
 import androidx.compose.ui.Modifier
 import androidx.lifecycle.viewmodel.compose.viewModel
 import androidx.navigation.NavType
 import androidx.navigation.compose.NavHost
 import androidx.navigation.compose.composable
 import androidx.navigation.compose.rememberNavController
 import androidx.navigation.navArgument
 import com.example.tvmoview.data.repository.MediaRepository
 import com.example.tvmoview.presentation.screens.*
-import com.example.tvmoview.presentation.theme.TVMovieTheme
-
-// OneDriveçµ±åˆã®ãŸã‚ã®æ–°ã—ã„import
-import com.example.tvmoview.data.auth.AuthenticationManager
-import com.example.tvmoview.data.repository.OneDriveRepository
-import com.example.tvmoview.data.db.MediaDatabaseProvider
+import com.example.tvmoview.presentation.theme.TVMovieTheme
+
+// OneDriveçµ±åˆã®ãŸã‚ã®æ–°ã—ã„import
+import com.example.tvmoview.data.auth.AuthenticationManager
+import com.example.tvmoview.data.repository.OneDriveRepository
+import com.example.tvmoview.data.db.MediaDatabaseProvider
+import com.example.tvmoview.data.prefs.UserPreferences
 import coil.ImageLoader
 import coil.Coil
 import coil.disk.DiskCache
 import coil.memory.MemoryCache
 import okhttp3.OkHttpClient
 
 class MainActivity : ComponentActivity() {
 
     companion object {
         lateinit var mediaRepository: MediaRepository
 
         // OneDriveçµ±åˆã®ãŸã‚ã®æ–°ã—ã„å¤‰æ•°
         lateinit var authManager: AuthenticationManager
         lateinit var oneDriveRepository: OneDriveRepository
     }
 
     override fun onCreate(savedInstanceState: Bundle?) {
         super.onCreate(savedInstanceState)
 
-        // æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”¨ï¼ˆãã®ã¾ã¾æ®‹ã™ï¼‰
-        mediaRepository = MediaRepository(this)
+        // æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”¨ï¼ˆãã®ã¾ã¾æ®‹ã™ï¼‰
+        mediaRepository = MediaRepository(this)
+
+        UserPreferences.init(this)
 
         // OneDriveçµ±åˆã®åˆæœŸåŒ–ï¼ˆæ–°è¦è¿½åŠ ï¼‰
         authManager = AuthenticationManager(this)
         MediaDatabaseProvider.init(this)
         oneDriveRepository = OneDriveRepository(
             authManager,
             MediaDatabaseProvider.database.mediaDao(),
             MediaDatabaseProvider.database.folderSyncDao()
         )
 
         val imageLoader = ImageLoader.Builder(this)
             .diskCache(
                 DiskCache.Builder()
                     .directory(cacheDir.resolve("image_cache"))
                     .maxSizeBytes(50L * 1024 * 1024) // 50MB
                     .build()
             )
             .memoryCache(
                 MemoryCache.Builder(this)
                     .maxSizePercent(0.15)
                     .build()
             )
             .okHttpClient {
                 OkHttpClient.Builder()
                     .addInterceptor { chain ->
diff --git a/app/src/main/java/com/example/tvmoview/data/prefs/UserPreferences.kt b/app/src/main/java/com/example/tvmoview/data/prefs/UserPreferences.kt
new file mode 100644
index 0000000000000000000000000000000000000000..38c3d9fe5324e2fc00fab8e64fa5977f3ecfa799
--- /dev/null
+++ b/app/src/main/java/com/example/tvmoview/data/prefs/UserPreferences.kt
@@ -0,0 +1,24 @@
+package com.example.tvmoview.data.prefs
+
+import android.content.Context
+import android.content.SharedPreferences
+
+object UserPreferences {
+    private lateinit var prefs: SharedPreferences
+
+    fun init(context: Context) {
+        prefs = context.getSharedPreferences("user_prefs", Context.MODE_PRIVATE)
+    }
+
+    var sortBy: String
+        get() = prefs.getString("sort_by", "NAME") ?: "NAME"
+        set(value) { prefs.edit().putString("sort_by", value).apply() }
+
+    var sortOrder: String
+        get() = prefs.getString("sort_order", "DESC") ?: "DESC"
+        set(value) { prefs.edit().putString("sort_order", value).apply() }
+
+    var tileColumns: Int
+        get() = prefs.getInt("tile_columns", 4)
+        set(value) { prefs.edit().putInt("tile_columns", value).apply() }
+}
diff --git a/app/src/main/java/com/example/tvmoview/data/repository/MediaRepository.kt b/app/src/main/java/com/example/tvmoview/data/repository/MediaRepository.kt
index 8c95d2cc731d3af6b966e2d0273a4252f1190fad..2dea68472c55daf45cb4d689c10bcce87788d10c 100644
--- a/app/src/main/java/com/example/tvmoview/data/repository/MediaRepository.kt
+++ b/app/src/main/java/com/example/tvmoview/data/repository/MediaRepository.kt
@@ -10,109 +10,112 @@ class MediaRepository(private val context: Context) {
     suspend fun getRootItems(): List<MediaItem> {
         delay(1000)
 
         return listOf(
             MediaItem(
                 id = "folder1",
                 name = "ğŸ“ å†™çœŸã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³",
                 size = 0,
                 lastModified = Date(),
                 isFolder = true
             ),
             MediaItem(
                 id = "folder2", 
                 name = "ğŸ“ å‹•ç”»ãƒ©ã‚¤ãƒ–ãƒ©ãƒª",
                 size = 0,
                 lastModified = Date(),
                 isFolder = true
             ),
             MediaItem(
                 id = "folder3",
                 name = "ğŸ“ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ",
                 size = 0,
                 lastModified = Date(),
                 isFolder = true
             ),
-            MediaItem(
-                id = "video1",
-                name = "ğŸ¬ å®¶æ—ã®æ€ã„å‡º.mp4",
-                size = 52428800,
-                lastModified = Date(System.currentTimeMillis() - 86400000),
-                mimeType = "video/mp4"
-            ),
-            MediaItem(
-                id = "video2",
-                name = "ğŸ¬ æ—…è¡Œè¨˜éŒ².mp4",
-                size = 85214800,
-                lastModified = Date(System.currentTimeMillis() - 172800000),
-                mimeType = "video/mp4"
-            ),
+            MediaItem(
+                id = "video1",
+                name = "ğŸ¬ å®¶æ—ã®æ€ã„å‡º.mp4",
+                size = 52428800,
+                lastModified = Date(System.currentTimeMillis() - 86400000),
+                mimeType = "video/mp4",
+                duration = 120000
+            ),
+            MediaItem(
+                id = "video2",
+                name = "ğŸ¬ æ—…è¡Œè¨˜éŒ².mp4",
+                size = 85214800,
+                lastModified = Date(System.currentTimeMillis() - 172800000),
+                mimeType = "video/mp4",
+                duration = 180000
+            ),
             MediaItem(
                 id = "image1",
                 name = "ğŸ–¼ï¸ å¤•æ—¥ã®é¢¨æ™¯.jpg",
                 size = 3145728,
                 lastModified = Date(System.currentTimeMillis() - 259200000),
                 mimeType = "image/jpeg"
             ),
             MediaItem(
                 id = "image2",
                 name = "ğŸ–¼ï¸ èŠ±ã®å†™çœŸ.jpg",
                 size = 2456789,
                 lastModified = Date(System.currentTimeMillis() - 345600000),
                 mimeType = "image/jpeg"
             )
         )
     }
 
     suspend fun getFolderItems(folderId: String): List<MediaItem> {
         delay(800)
 
         return when (folderId) {
             "folder1" -> {
                 // å†™çœŸãƒ•ã‚©ãƒ«ãƒ€ã®å†…å®¹
                 (1..12).map { i ->
                     MediaItem(
                         id = "image_$i",
                         name = "ğŸ“¸ å†™çœŸ$i.jpg",
                         size = (1000000..5000000).random().toLong(),
                         lastModified = Date(System.currentTimeMillis() - i * 86400000),
                         mimeType = "image/jpeg"
                     )
                 }
             }
-            "folder2" -> {
-                // å‹•ç”»ãƒ•ã‚©ãƒ«ãƒ€ã®å†…å®¹
-                (1..8).map { i ->
-                    MediaItem(
-                        id = "video_$i",
-                        name = "ğŸ¥ å‹•ç”»$i.mp4",
-                        size = (50000000..200000000).random().toLong(),
-                        lastModified = Date(System.currentTimeMillis() - i * 86400000),
-                        mimeType = "video/mp4"
-                    )
-                }
-            }
+            "folder2" -> {
+                // å‹•ç”»ãƒ•ã‚©ãƒ«ãƒ€ã®å†…å®¹
+                (1..8).map { i ->
+                    MediaItem(
+                        id = "video_$i",
+                        name = "ğŸ¥ å‹•ç”»$i.mp4",
+                        size = (50000000..200000000).random().toLong(),
+                        lastModified = Date(System.currentTimeMillis() - i * 86400000),
+                        mimeType = "video/mp4",
+                        duration = (60_000L * (1 + i))
+                    )
+                }
+            }
             "folder3" -> {
                 // ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã®å†…å®¹
                 listOf(
                     MediaItem(
                         id = "doc1",
                         name = "ğŸ“„ é‡è¦è³‡æ–™.pdf",
                         size = 1234567,
                         lastModified = Date(),
                         mimeType = "application/pdf"
                     ),
                     MediaItem(
                         id = "doc2",
                         name = "ğŸ“„ ãƒ—ãƒ¬ã‚¼ãƒ³è³‡æ–™.pptx",
                         size = 2345678,
                         lastModified = Date(),
                         mimeType = "application/vnd.ms-powerpoint"
                     )
                 )
             }
             else -> emptyList()
         }
     }
 
     fun getCurrentPath(folderId: String?): String {
         return when (folderId) {
diff --git a/app/src/main/java/com/example/tvmoview/domain/model/MediaItem.kt b/app/src/main/java/com/example/tvmoview/domain/model/MediaItem.kt
index d84ae190e9fff95b095494eb20a4414a26f3adbf..2b3396f8fc2a398b91d47cd228ac7f05a0637f75 100644
--- a/app/src/main/java/com/example/tvmoview/domain/model/MediaItem.kt
+++ b/app/src/main/java/com/example/tvmoview/domain/model/MediaItem.kt
@@ -1,31 +1,32 @@
 ï»¿package com.example.tvmoview.domain.model
 
 import java.util.*
 
 data class MediaItem(
     val id: String,
     val name: String,
     val size: Long = 0,
     val lastModified: Date = Date(),
     val mimeType: String? = null,
-    val isFolder: Boolean = false,
-    val thumbnailUrl: String? = null,
-    val downloadUrl: String? = null  // OneDriveç”¨ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰URLè¿½åŠ 
-) {
+    val isFolder: Boolean = false,
+    val thumbnailUrl: String? = null,
+    val downloadUrl: String? = null,  // OneDriveç”¨ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰URLè¿½åŠ 
+    val duration: Long = 0L
+) {
     val isVideo: Boolean
         get() = mimeType?.startsWith("video/") == true
 
     val isImage: Boolean
         get() = mimeType?.startsWith("image/") == true
 
     val fileExtension: String
         get() = name.substringAfterLast(".", "")
 
     val formattedSize: String
         get() = when {
             size < 1024 -> "${size}B"
             size < 1024 * 1024 -> "${size / 1024}KB"
             size < 1024 * 1024 * 1024 -> "${size / (1024 * 1024)}MB"
             else -> "${size / (1024 * 1024 * 1024)}GB"
         }
 }
\ No newline at end of file
diff --git a/app/src/main/java/com/example/tvmoview/presentation/components/ModernMediaCard.kt b/app/src/main/java/com/example/tvmoview/presentation/components/ModernMediaCard.kt
index d5d1591b2023e166cc8ada354a43994cdeeae63d..66b23e0ca60b3251d9bd924348f77e9313f76f4a 100644
--- a/app/src/main/java/com/example/tvmoview/presentation/components/ModernMediaCard.kt
+++ b/app/src/main/java/com/example/tvmoview/presentation/components/ModernMediaCard.kt
@@ -3,184 +3,213 @@
 import androidx.compose.animation.core.*
 import androidx.compose.foundation.background
 import androidx.compose.foundation.clickable
 import androidx.compose.foundation.layout.*
 import androidx.compose.material.icons.Icons
 import androidx.compose.material.icons.filled.*
 import androidx.compose.material3.*
 import androidx.compose.runtime.*
 import androidx.compose.ui.Alignment
 import androidx.compose.ui.Modifier
 import androidx.compose.ui.geometry.Offset
 import androidx.compose.ui.graphics.Brush
 import androidx.compose.ui.graphics.Color
 import androidx.compose.ui.layout.ContentScale
 import androidx.compose.ui.platform.LocalContext
 import androidx.compose.ui.text.style.TextOverflow
 import androidx.compose.ui.unit.dp
 import coil.compose.SubcomposeAsyncImage
 import coil.request.ImageRequest
 import coil.request.CachePolicy
 import com.example.tvmoview.domain.model.MediaItem
 import java.text.SimpleDateFormat
 import java.util.*
 
 @Composable
-fun ModernMediaCard(
-    item: MediaItem,
-    onClick: () -> Unit,
-    loadPriority: Float = 0.5f
-) {
+fun ModernMediaCard(
+    item: MediaItem,
+    onClick: () -> Unit,
+    loadPriority: Float = 0.5f,
+    showName: Boolean = true
+) {
     Card(
         modifier = Modifier
-            .fillMaxWidth()
-            .height(200.dp)
-            .clickable { onClick() },
+            .fillMaxWidth()
+            .aspectRatio(1f)
+            .clickable { onClick() },
         elevation = CardDefaults.cardElevation(defaultElevation = 4.dp)
     ) {
         Column(modifier = Modifier.fillMaxSize()) {
             Box(
                 modifier = Modifier.fillMaxWidth().weight(1f),
                 contentAlignment = Alignment.Center
             ) {
                 val context = LocalContext.current
 
-                when {
-                    item.thumbnailUrl != null || (item.isVideo || item.isImage) -> {
-                        SubcomposeAsyncImage(
+                when {
+                    item.thumbnailUrl != null || (item.isVideo || item.isImage) -> {
+                        SubcomposeAsyncImage(
                             model = ImageRequest.Builder(context)
                                 .data(item.thumbnailUrl ?: generateVideoThumbnail(item))
                                 .diskCacheKey("thumb_${item.id}")
                                 .crossfade(300)
                                 .size(400, 300)
                                 .memoryCachePolicy(CachePolicy.ENABLED)
                                 .diskCachePolicy(CachePolicy.ENABLED)
                                 .build(),
                             contentDescription = null,
                             contentScale = ContentScale.Crop,
                             modifier = Modifier.fillMaxSize(),
                             loading = {
                                 Box(
                                     modifier = Modifier
                                         .fillMaxSize()
                                         .background(
                                             shimmerBrush(
                                                 targetValue = 1300f,
                                                 showShimmer = true
                                             )
                                         )
                                 )
                             },
-                            error = {
-                                Box(
-                                    modifier = Modifier.fillMaxSize(),
-                                    contentAlignment = Alignment.Center
-                                ) {
-                                    Icon(
-                                        imageVector = when {
-                                            item.isVideo -> Icons.Default.PlayArrow
-                                            item.isImage -> Icons.Default.Image
-                                            else -> Icons.Default.Description
-                                        },
-                                        contentDescription = null,
-                                        modifier = Modifier.size(48.dp),
-                                        tint = MaterialTheme.colorScheme.primary
-                                    )
-                                }
-                            }
-                        )
-                    }
-                    item.isFolder -> {
+                            error = {
+                                Box(
+                                    modifier = Modifier.fillMaxSize(),
+                                    contentAlignment = Alignment.Center
+                                ) {
+                                    Icon(
+                                        imageVector = when {
+                                            item.isVideo -> Icons.Default.PlayArrow
+                                            item.isImage -> Icons.Default.Image
+                                            else -> Icons.Default.Description
+                                        },
+                                        contentDescription = null,
+                                        modifier = Modifier.size(48.dp),
+                                        tint = MaterialTheme.colorScheme.primary
+                                    )
+                                }
+                            }
+                        )
+                        if (item.isVideo) {
+                            Icon(
+                                imageVector = Icons.Default.PlayArrow,
+                                contentDescription = null,
+                                tint = Color.White,
+                                modifier = Modifier
+                                    .align(Alignment.Center)
+                                    .size(48.dp)
+                            )
+                            Text(
+                                text = formatTime(item.duration),
+                                color = Color.White,
+                                style = MaterialTheme.typography.bodySmall,
+                                modifier = Modifier
+                                    .align(Alignment.BottomEnd)
+                                    .background(Color.Black.copy(alpha = 0.6f))
+                                    .padding(4.dp)
+                            )
+                        }
+                    }
+                    item.isFolder -> {
                         Icon(
                             imageVector = Icons.Default.Folder,
                             contentDescription = null,
                             modifier = Modifier.size(48.dp),
                             tint = MaterialTheme.colorScheme.primary
                         )
                     }
                     else -> {
                         Icon(
                             imageVector = Icons.Default.Description,
                             contentDescription = null,
                             modifier = Modifier.size(48.dp),
                             tint = MaterialTheme.colorScheme.primary
                         )
                     }
                 }
             }
 
-            Column(modifier = Modifier.padding(12.dp)) {
-                Text(
-                    text = item.name,
-                    style = MaterialTheme.typography.bodyMedium,
-                    maxLines = 2,
-                    overflow = TextOverflow.Ellipsis
-                )
-
-                if (!item.isFolder) {
-                    val dateFormat = SimpleDateFormat("yyyy/MM/dd", Locale.getDefault())
-                    Text(
-                        text = "${formatFileSize(item.size)} â€¢ ${dateFormat.format(item.lastModified)}",
-                        style = MaterialTheme.typography.bodySmall,
-                        color = MaterialTheme.colorScheme.onSurfaceVariant
-                    )
-                }
-            }
-        }
-    }
-}
+            Column(modifier = Modifier.padding(12.dp)) {
+                if (showName) {
+                    Text(
+                        text = item.name,
+                        style = MaterialTheme.typography.bodyMedium,
+                        maxLines = 2,
+                        overflow = TextOverflow.Ellipsis
+                    )
+
+                    if (!item.isFolder) {
+                        val dateFormat = SimpleDateFormat("yyyy/MM/dd", Locale.getDefault())
+                        Text(
+                            text = "${formatFileSize(item.size)} â€¢ ${dateFormat.format(item.lastModified)}",
+                            style = MaterialTheme.typography.bodySmall,
+                            color = MaterialTheme.colorScheme.onSurfaceVariant
+                        )
+                    }
+                }
+            }
+        }
+    }
+}
 
 // å‹•ç”»ã‚µãƒ ãƒã‚¤ãƒ«URLç”Ÿæˆ
 private fun generateVideoThumbnail(item: MediaItem): String? {
     return if (item.isVideo && item.id.isNotEmpty() && !item.id.startsWith("test")) {
         "https://graph.microsoft.com/v1.0/me/drive/items/${item.id}/thumbnails/0/large/content"
     } else {
         item.thumbnailUrl
     }
 }
 
 // ã‚·ãƒãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆç”¨ãƒ–ãƒ©ã‚·
 @Composable
 fun shimmerBrush(targetValue: Float = 1000f, showShimmer: Boolean = true): Brush {
     return if (showShimmer) {
         val shimmerColors = listOf(
             Color.LightGray.copy(alpha = 0.6f),
             Color.LightGray.copy(alpha = 0.2f),
             Color.LightGray.copy(alpha = 0.6f),
         )
 
         val transition = rememberInfiniteTransition(label = "shimmer")
         val translateAnimation = transition.animateFloat(
             initialValue = 0f,
             targetValue = targetValue,
             animationSpec = infiniteRepeatable(
                 animation = tween(800),
                 repeatMode = RepeatMode.Reverse
             ),
             label = "shimmer"
         )
         Brush.linearGradient(
             colors = shimmerColors,
             start = Offset.Zero,
             end = Offset(x = translateAnimation.value, y = translateAnimation.value)
         )
     } else {
         Brush.linearGradient(
             colors = listOf(Color.Transparent, Color.Transparent),
             start = Offset.Zero,
             end = Offset.Zero
         )
     }
 }
 
-private fun formatFileSize(size: Long): String {
+private fun formatFileSize(size: Long): String {
     val kb = 1024
     val mb = kb * 1024
     val gb = mb * 1024
 
     return when {
         size >= gb -> String.format("%.1f GB", size.toDouble() / gb)
         size >= mb -> String.format("%.1f MB", size.toDouble() / mb)
         size >= kb -> String.format("%.1f KB", size.toDouble() / kb)
         else -> "$size B"
     }
+}
+
+private fun formatTime(ms: Long): String {
+    val totalSec = ms / 1000
+    val min = totalSec / 60
+    val sec = totalSec % 60
+    return "%d:%02d".format(min, sec)
 }
\ No newline at end of file
diff --git a/app/src/main/java/com/example/tvmoview/presentation/components/ModernTileView.kt b/app/src/main/java/com/example/tvmoview/presentation/components/ModernTileView.kt
index 947686c45644399b299f81be7f658b37601d5042..6dfa6679ac229caa3f852961dad264e3fe3e7ab1 100644
--- a/app/src/main/java/com/example/tvmoview/presentation/components/ModernTileView.kt
+++ b/app/src/main/java/com/example/tvmoview/presentation/components/ModernTileView.kt
@@ -1,51 +1,55 @@
 ï»¿package com.example.tvmoview.presentation.components
 
 import androidx.compose.foundation.layout.*
 import androidx.compose.foundation.lazy.grid.*
 import androidx.compose.runtime.Composable
 import androidx.compose.ui.Modifier
 import androidx.compose.ui.unit.dp
 import com.example.tvmoview.domain.model.MediaItem
 
 @Composable
-fun ModernTileView(
-    items: List<MediaItem>,
-    onItemClick: (MediaItem) -> Unit
-) {
-    LazyVerticalGrid(
-        columns = GridCells.Adaptive(minSize = 200.dp),
-        contentPadding = PaddingValues(16.dp),
-        horizontalArrangement = Arrangement.spacedBy(16.dp),
-        verticalArrangement = Arrangement.spacedBy(16.dp)
-    ) {
-        itemsIndexed(items) { index, item ->
+fun ModernTileView(
+    items: List<MediaItem>,
+    columnCount: Int,
+    state: LazyGridState,
+    onItemClick: (MediaItem) -> Unit
+) {
+    LazyVerticalGrid(
+        columns = GridCells.Fixed(columnCount),
+        state = state,
+        contentPadding = PaddingValues(0.dp),
+        horizontalArrangement = Arrangement.spacedBy(0.dp),
+        verticalArrangement = Arrangement.spacedBy(0.dp)
+    ) {
+        itemsIndexed(items) { index, item ->
             // è¡¨ç¤ºå„ªå…ˆåº¦ã‚’è¨­å®š
             val priority = when {
                 index < 10 -> 1.0f  // æœ€åˆã®10å€‹ã¯æœ€å„ªå…ˆ
                 index < 30 -> 0.5f  // æ¬¡ã®20å€‹ã¯ä¸­å„ªå…ˆåº¦
                 else -> 0.1f        // ãã‚Œä»¥é™ã¯ä½å„ªå…ˆåº¦
             }
 
-            ModernMediaCard(
-                item = item,
-                onClick = { onItemClick(item) },
-                loadPriority = priority
-            )
-        }
-    }
-}
+            ModernMediaCard(
+                item = item,
+                onClick = { onItemClick(item) },
+                loadPriority = priority,
+                showName = item.isFolder
+            )
+        }
+    }
+}
 
 //    // ãƒ—ãƒªãƒ•ã‚§ãƒƒãƒè¨­å®š
 //    LaunchedEffect(gridState) {
 //        snapshotFlow { gridState.firstVisibleItemIndex }
 //            .collect { firstVisible ->
 //                // è¦‹ãˆã‚‹ç¯„å›²ã®å‰å¾Œã‚’ãƒ—ãƒªãƒ•ã‚§ãƒƒãƒ
 //                val prefetchRange = 10
 //                val start = (firstVisible - prefetchRange).coerceAtLeast(0)
 //                val end = (firstVisible + prefetchRange).coerceAtMost(items.size - 1)
 //
 //                // ã“ã“ã§ãƒ—ãƒªãƒ•ã‚§ãƒƒãƒå‡¦ç†ã‚’å®Ÿè¡Œ
 //                Log.d("ModernTileView", "Prefetch range: $start to $end")
 //            }
 //    }
 //}
\ No newline at end of file
diff --git a/app/src/main/java/com/example/tvmoview/presentation/components/ModernTopBar.kt b/app/src/main/java/com/example/tvmoview/presentation/components/ModernTopBar.kt
index 2f5f18b8b6c2757de0542cc3f5e17506cd63f47e..2f8a70155588f01122ac92f5a591a33fd2ecfe58 100644
--- a/app/src/main/java/com/example/tvmoview/presentation/components/ModernTopBar.kt
+++ b/app/src/main/java/com/example/tvmoview/presentation/components/ModernTopBar.kt
@@ -1,54 +1,59 @@
 ï»¿package com.example.tvmoview.presentation.components
 
 import androidx.compose.animation.core.*
 import androidx.compose.foundation.layout.*
 import androidx.compose.material.icons.Icons
 import androidx.compose.material.icons.filled.*
 import androidx.compose.material3.*
 import androidx.compose.runtime.*
 import androidx.compose.ui.Alignment
 import androidx.compose.ui.Modifier
 import androidx.compose.ui.graphics.graphicsLayer
 import androidx.compose.ui.text.font.FontWeight
 import androidx.compose.ui.unit.dp
 
 // ViewMode importè¿½åŠ 
-import com.example.tvmoview.presentation.viewmodels.ViewMode
+import com.example.tvmoview.presentation.viewmodels.ViewMode
+import com.example.tvmoview.presentation.viewmodels.SortOrder
 
 @OptIn(ExperimentalMaterial3Api::class)
 @Composable
-fun ModernTopBar(
-    currentPath: String,
-    viewMode: ViewMode,
-    onViewModeChange: () -> Unit,
-    onSortClick: () -> Unit,
-    onRefreshClick: () -> Unit,
-    onSettingsClick: (() -> Unit)? = null,
-    onBackClick: (() -> Unit)? = null,
-    isLoading: Boolean = false
-) {
+fun ModernTopBar(
+    currentPath: String,
+    viewMode: ViewMode,
+    sortOrder: SortOrder,
+    tileColumns: Int,
+    onViewModeChange: () -> Unit,
+    onTileColumnsChange: () -> Unit,
+    onSortClick: () -> Unit,
+    onOrderToggle: () -> Unit,
+    onRefreshClick: () -> Unit,
+    onSettingsClick: (() -> Unit)? = null,
+    onBackClick: (() -> Unit)? = null,
+    isLoading: Boolean = false
+) {
     // å›è»¢ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
     val rotation by animateFloatAsState(
         targetValue = if (isLoading) 360f else 0f,
         animationSpec = if (isLoading) {
             infiniteRepeatable(
                 animation = tween(1000, easing = LinearEasing),
                 repeatMode = RepeatMode.Restart
             )
         } else {
             tween(200)
         },
         label = "refresh_rotation"
     )
 
     TopAppBar(
         title = {
             Row(
                 modifier = Modifier.fillMaxWidth(),
                 verticalAlignment = Alignment.CenterVertically
             ) {
                 if (onBackClick != null) {
                     IconButton(onClick = onBackClick) {
                         Icon(
                             imageVector = Icons.Default.ArrowBack,
                             contentDescription = "æˆ»ã‚‹"
@@ -63,60 +68,73 @@ fun ModernTopBar(
                         Text(
                             text = "TV Movie Viewer",
                             style = MaterialTheme.typography.titleMedium,
                             fontWeight = FontWeight.Bold,
                             modifier = Modifier.weight(1f, fill = false)
                         )
                         // æ›´æ–°ä¸­è¡¨ç¤º
                         if (isLoading) {
                             Spacer(modifier = Modifier.width(8.dp))
                             Text(
                                 text = "æ›´æ–°ä¸­...",
                                 style = MaterialTheme.typography.bodySmall,
                                 color = MaterialTheme.colorScheme.primary
                             )
                         }
                     }
                     Text(
                         text = currentPath,
                         style = MaterialTheme.typography.bodySmall,
                         color = MaterialTheme.colorScheme.onSurfaceVariant
                     )
                 }
             }
         },
         actions = {
-            // è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³
-            IconButton(onClick = onViewModeChange) {
-                Icon(
-                    imageVector = when (viewMode) {
-                        ViewMode.TILE -> Icons.Default.ViewList
-                        ViewMode.LIST -> Icons.Default.ViewModule
-                    },
-                    contentDescription = "è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ"
-                )
-            }
+            // è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³
+            IconButton(onClick = onViewModeChange) {
+                Icon(
+                    imageVector = when (viewMode) {
+                        ViewMode.TILE -> Icons.Default.ViewList
+                        ViewMode.LIST -> Icons.Default.ViewModule
+                    },
+                    contentDescription = "è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ"
+                )
+            }
+
+            if (viewMode == ViewMode.TILE) {
+                IconButton(onClick = onTileColumnsChange) {
+                    Text(tileColumns.toString())
+                }
+            }
+
+            IconButton(onClick = onOrderToggle) {
+                Icon(
+                    imageVector = if (sortOrder == SortOrder.ASC) Icons.Default.ArrowUpward else Icons.Default.ArrowDownward,
+                    contentDescription = "ä¸¦ã³é †æ–¹å‘"
+                )
+            }
 
             // æ›´æ–°ãƒœã‚¿ãƒ³ï¼ˆå›è»¢ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãï¼‰
             IconButton(
                 onClick = { if (!isLoading) onRefreshClick() },
                 enabled = !isLoading
             ) {
                 Icon(
                     imageVector = Icons.Default.Refresh,
                     contentDescription = if (isLoading) "æ›´æ–°ä¸­" else "æ›´æ–°",
                     modifier = Modifier.graphicsLayer {
                         rotationZ = rotation
                     }
                 )
             }
 
             // ã‚½ãƒ¼ãƒˆãƒœã‚¿ãƒ³
             IconButton(onClick = onSortClick) {
                 Icon(
                     imageVector = Icons.Default.Sort,
                     contentDescription = "ä¸¦ã³é †"
                 )
             }
 
             // è¨­å®šãƒœã‚¿ãƒ³
             if (onSettingsClick != null) {
diff --git a/app/src/main/java/com/example/tvmoview/presentation/components/SortDialog.kt b/app/src/main/java/com/example/tvmoview/presentation/components/SortDialog.kt
index 23f45a2ab231ffc3a98cfb7af87b316dfab108b6..32809f68624284a106db1f744a03ece18c1543e2 100644
--- a/app/src/main/java/com/example/tvmoview/presentation/components/SortDialog.kt
+++ b/app/src/main/java/com/example/tvmoview/presentation/components/SortDialog.kt
@@ -1,62 +1,101 @@
 ï»¿package com.example.tvmoview.presentation.components
 
 import androidx.compose.foundation.layout.*
 import androidx.compose.foundation.selection.selectable
 import androidx.compose.material3.*
 import androidx.compose.runtime.*
 import androidx.compose.ui.Alignment
 import androidx.compose.ui.Modifier
 import androidx.compose.ui.unit.dp
 
 // SortBy importè¿½åŠ 
-import com.example.tvmoview.presentation.viewmodels.SortBy
+import com.example.tvmoview.presentation.viewmodels.SortBy
+import com.example.tvmoview.presentation.viewmodels.SortOrder
 
 @Composable
-fun SortDialog(
-    currentSort: SortBy,
-    onSortSelected: (SortBy) -> Unit,
-    onDismiss: () -> Unit
-) {
+fun SortDialog(
+    currentSort: SortBy,
+    currentOrder: SortOrder,
+    onSortSelected: (SortBy) -> Unit,
+    onOrderSelected: (SortOrder) -> Unit,
+    onDismiss: () -> Unit
+) {
     AlertDialog(
         onDismissRequest = onDismiss,
         title = {
             Text("ä¸¦ã³é †")
         },
         text = {
-            Column {
-                SortBy.values().forEach { sortOption ->
+            Column {
+                SortBy.values().forEach { sortOption ->
                     Row(
                         modifier = Modifier
                             .fillMaxWidth()
                             .selectable(
                                 selected = currentSort == sortOption,
                                 onClick = { onSortSelected(sortOption) }
                             )
                             .padding(vertical = 8.dp),
                         verticalAlignment = Alignment.CenterVertically
                     ) {
                         RadioButton(
                             selected = currentSort == sortOption,
                             onClick = { onSortSelected(sortOption) }
                         )
                         Spacer(modifier = Modifier.width(8.dp))
                         Text(
                             text = when (sortOption) {
                                 SortBy.NAME -> "åå‰é †"
                                 SortBy.DATE -> "æ›´æ–°æ—¥æ™‚é †"
                                 SortBy.SIZE -> "ã‚µã‚¤ã‚ºé †"
-                                SortBy.TYPE -> "ç¨®é¡é †"
-                            },
+                                SortBy.TYPE -> "ç¨®é¡é †"
+                                SortBy.SHOOT -> "æ’®å½±æ—¥é †"
+                            },
                             style = MaterialTheme.typography.bodyMedium
                         )
                     }
-                }
-            }
-        },
+                }
+                Spacer(modifier = Modifier.height(8.dp))
+                Row(
+                    modifier = Modifier
+                        .fillMaxWidth()
+                        .selectable(
+                            selected = currentOrder == SortOrder.ASC,
+                            onClick = { onOrderSelected(SortOrder.ASC) }
+                        )
+                        .padding(vertical = 8.dp),
+                    verticalAlignment = Alignment.CenterVertically
+                ) {
+                    RadioButton(
+                        selected = currentOrder == SortOrder.ASC,
+                        onClick = { onOrderSelected(SortOrder.ASC) }
+                    )
+                    Spacer(modifier = Modifier.width(8.dp))
+                    Text("æ˜‡é †")
+                }
+                Row(
+                    modifier = Modifier
+                        .fillMaxWidth()
+                        .selectable(
+                            selected = currentOrder == SortOrder.DESC,
+                            onClick = { onOrderSelected(SortOrder.DESC) }
+                        )
+                        .padding(vertical = 8.dp),
+                    verticalAlignment = Alignment.CenterVertically
+                ) {
+                    RadioButton(
+                        selected = currentOrder == SortOrder.DESC,
+                        onClick = { onOrderSelected(SortOrder.DESC) }
+                    )
+                    Spacer(modifier = Modifier.width(8.dp))
+                    Text("é™é †")
+                }
+            }
+        },
         confirmButton = {
             TextButton(onClick = onDismiss) {
                 Text("é–‰ã˜ã‚‹")
             }
         }
     )
 }
\ No newline at end of file
diff --git a/app/src/main/java/com/example/tvmoview/presentation/screens/HighQualityPlayerScreen.kt b/app/src/main/java/com/example/tvmoview/presentation/screens/HighQualityPlayerScreen.kt
index 7264eb64ba4e83f96d0e4fd6e6d322c86d92fe7f..20275d080bb9edc64e751af67f7156245816392a 100644
--- a/app/src/main/java/com/example/tvmoview/presentation/screens/HighQualityPlayerScreen.kt
+++ b/app/src/main/java/com/example/tvmoview/presentation/screens/HighQualityPlayerScreen.kt
@@ -1,114 +1,119 @@
 ï»¿package com.example.tvmoview.presentation.screens
 
 import android.content.Context
 import android.util.Log
 import androidx.activity.compose.BackHandler
 import androidx.compose.foundation.background
 import androidx.compose.foundation.focusable
 import androidx.compose.foundation.layout.*
 import androidx.compose.material3.*
-import androidx.compose.runtime.*
+import androidx.compose.runtime.*
+import androidx.compose.runtime.getValue
+import androidx.compose.runtime.setValue
 import androidx.compose.ui.Alignment
 import androidx.compose.ui.Modifier
 import androidx.compose.ui.focus.FocusRequester
 import androidx.compose.ui.focus.focusRequester
 import androidx.compose.ui.graphics.Color
 import androidx.compose.ui.input.key.*
 import androidx.compose.ui.platform.LocalContext
 import androidx.compose.ui.text.font.FontWeight
 import androidx.compose.ui.unit.dp
 import androidx.compose.ui.viewinterop.AndroidView
 import kotlinx.coroutines.delay
 import kotlinx.coroutines.launch
 import androidx.media3.common.MediaItem
 import androidx.media3.exoplayer.ExoPlayer
 import androidx.media3.ui.PlayerView
 import com.example.tvmoview.MainActivity
 import kotlinx.coroutines.delay
 
 @Composable
 fun HighQualityPlayerScreen(
     itemId: String,
     onBack: () -> Unit,
     downloadUrl: String = ""
 ) {
     val context = LocalContext.current
     val focusRequester = remember { FocusRequester() }
     val coroutineScope = rememberCoroutineScope() // è¿½åŠ 
 
     // ã‚«ã‚¹ã‚¿ãƒ ã‚·ãƒ¼ã‚¯ãƒãƒ¼è¡¨ç¤ºåˆ¶å¾¡
     var showCustomSeek by remember { mutableStateOf(false) }
     var currentPosition by remember { mutableLongStateOf(0L) }
     var duration by remember { mutableLongStateOf(0L) }
-    var seekMessage by remember { mutableStateOf("") }
+    var seekMessage by remember { mutableStateOf("") }
+    val showInfo = remember { mutableStateOf(true) }
 
     // PlayerViewå‚ç…§ç”¨ã¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼åˆ¶å¾¡
     var playerView by remember { mutableStateOf<PlayerView?>(null) }
     var lastBackPressTime by remember { mutableLongStateOf(0L) }
 
     Log.d("VideoPlayer", "ğŸ¬ ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼èµ·å‹•: itemId=$itemId")
 
     // ExoPlayeråˆæœŸåŒ–
     val exoPlayer = remember {
         ExoPlayer.Builder(context).build().also { player ->
             val videoUrl = getVideoUrlSafely(itemId, downloadUrl, context)
             Log.d("VideoPlayer", "ğŸ“º å‹•ç”»URLè¨­å®š: $videoUrl")
 
             val mediaItem = MediaItem.fromUri(videoUrl)
             player.setMediaItem(mediaItem)
             player.prepare()
             player.playWhenReady = true
         }
     }
 
     // ã‚«ã‚¹ã‚¿ãƒ ã‚·ãƒ¼ã‚¯ãƒãƒ¼è¡¨ç¤ºã‚³ãƒ«ãƒ¼ãƒãƒ³
     fun showSeekBarTemporarily(message: String) {
         currentPosition = exoPlayer.currentPosition
         duration = exoPlayer.duration
         seekMessage = message
         showCustomSeek = true
 
         // 1ç§’å¾Œã«è‡ªå‹•éè¡¨ç¤º
         coroutineScope.launch {
             delay(1000)
             showCustomSeek = false
         }
     }
 
     // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
     DisposableEffect(Unit) {
         onDispose {
             Log.d("VideoPlayer", "ğŸ§¹ ExoPlayerè§£æ”¾")
             exoPlayer.release()
         }
     }
 
     // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹è¨­å®š
-    LaunchedEffect(Unit) {
-        focusRequester.requestFocus()
-    }
+    LaunchedEffect(Unit) {
+        focusRequester.requestFocus()
+        kotlinx.coroutines.delay(3000)
+        showInfo.value = false
+    }
 
     // æˆ»ã‚‹ãƒœã‚¿ãƒ³åˆ¶å¾¡ï¼ˆãƒ€ãƒ–ãƒ«ãƒ—ãƒ¬ã‚¹æ–¹å¼ï¼‰
     BackHandler {
         val currentTime = System.currentTimeMillis()
         if (currentTime - lastBackPressTime < 1000) {
             // 1ç§’ä»¥å†…ã®2å›ç›®ï¼šå®Ÿéš›ã«æˆ»ã‚‹
             Log.d("VideoPlayer", "ğŸ”™ ç”»é¢ã‚’æˆ»ã‚‹ï¼ˆãƒ€ãƒ–ãƒ«ãƒ—ãƒ¬ã‚¹ï¼‰")
             onBack()
         } else {
             // 1å›ç›®ï¼šã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’éš ã—ã¦æ™‚é–“è¨˜éŒ²
             playerView?.hideController()
             lastBackPressTime = currentTime
             Log.d("VideoPlayer", "ğŸ® ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«éè¡¨ç¤ºï¼ˆ1å›ç›®ã®ãƒ—ãƒ¬ã‚¹ï¼‰")
         }
     }
 
     Box(
         modifier = Modifier
             .fillMaxSize()
             .background(Color.Black)
             .focusRequester(focusRequester)
             .focusable()
             .onKeyEvent { keyEvent ->
                 if (keyEvent.type == KeyEventType.KeyDown) {
                     when (keyEvent.key) {
@@ -165,62 +170,73 @@ fun HighQualityPlayerScreen(
                             } else {
                                 // 1å›ç›®ï¼šã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’éš ã—ã¦æ™‚é–“è¨˜éŒ²
                                 playerView?.hideController()
                                 lastBackPressTime = currentTime
                                 Log.d("VideoPlayer", "ğŸ® ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«éè¡¨ç¤ºï¼ˆ1å›ç›®ã®ãƒ—ãƒ¬ã‚¹ï¼‰")
                             }
                             true
                         }
                         // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ç”¨ï¼ˆé–‹ç™ºæ™‚ï¼‰
                         Key.Spacebar -> {
                             if (exoPlayer.isPlaying) {
                                 exoPlayer.pause()
                             } else {
                                 exoPlayer.play()
                             }
                             true
                         }
                         else -> false
                     }
                 } else {
                     false
                 }
             }
     ) {
         // ExoPlayerè¡¨ç¤º
-        AndroidView(
-            factory = { ctx ->
-                PlayerView(ctx).apply {
-                    player = exoPlayer
-                    useController = true
-                    setShowSubtitleButton(true)
-                    setShowVrButton(false)
-                    playerView = this // å‚ç…§ã‚’ä¿å­˜
-                }
-            },
-            modifier = Modifier.fillMaxSize()
-        )
+        AndroidView(
+            factory = { ctx ->
+                PlayerView(ctx).apply {
+                    player = exoPlayer
+                    useController = true
+                    setShowSubtitleButton(true)
+                    setShowVrButton(false)
+                    playerView = this // å‚ç…§ã‚’ä¿å­˜
+                }
+            },
+            modifier = Modifier.fillMaxSize()
+        )
+
+        if (showInfo.value) {
+            Box(
+                modifier = Modifier
+                    .align(Alignment.TopStart)
+                    .background(Color.Black.copy(alpha = 0.6f))
+                    .padding(8.dp)
+            ) {
+                Text(itemId, color = Color.White)
+            }
+        }
 
         // ã‚«ã‚¹ã‚¿ãƒ ã‚·ãƒ¼ã‚¯ãƒãƒ¼ï¼ˆä¸€æ™‚è¡¨ç¤ºï¼‰
         if (showCustomSeek && duration > 0) {
             Box(
                 modifier = Modifier
                     .align(Alignment.BottomCenter)
                     .fillMaxWidth()
                     .padding(horizontal = 48.dp, vertical = 32.dp)
             ) {
                 Card(
                     colors = CardDefaults.cardColors(
                         containerColor = Color.Black.copy(alpha = 0.8f)
                     ),
                     modifier = Modifier.fillMaxWidth()
                 ) {
                     Column(
                         modifier = Modifier.padding(16.dp)
                     ) {
                         // ã‚·ãƒ¼ã‚¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
                         Text(
                             text = seekMessage,
                             color = Color.White,
                             style = MaterialTheme.typography.bodyMedium,
                             fontWeight = FontWeight.Bold,
                             modifier = Modifier.align(Alignment.CenterHorizontally)
diff --git a/app/src/main/java/com/example/tvmoview/presentation/screens/ImageViewerScreen.kt b/app/src/main/java/com/example/tvmoview/presentation/screens/ImageViewerScreen.kt
index 307b37eedc9537ce1327b3bef422f434511e9efb..eb8e83f29191fde420cf3df237242162bb669c86 100644
--- a/app/src/main/java/com/example/tvmoview/presentation/screens/ImageViewerScreen.kt
+++ b/app/src/main/java/com/example/tvmoview/presentation/screens/ImageViewerScreen.kt
@@ -1,109 +1,117 @@
 ï»¿package com.example.tvmoview.presentation.screens
 
 import android.util.Log
 import androidx.activity.compose.BackHandler
 import androidx.compose.foundation.background
 import androidx.compose.foundation.focusable
 import androidx.compose.foundation.layout.*
 import androidx.compose.material.icons.Icons
 import androidx.compose.material.icons.filled.BrokenImage
 import androidx.compose.material3.*
-import androidx.compose.runtime.*
+import androidx.compose.runtime.*
+import androidx.compose.runtime.getValue
+import androidx.compose.runtime.setValue
 import androidx.compose.ui.Alignment
 import androidx.compose.ui.Modifier
 import androidx.compose.ui.focus.FocusRequester
 import androidx.compose.ui.focus.focusRequester
 import androidx.compose.ui.graphics.Color
 import androidx.compose.ui.input.key.*
 import androidx.compose.ui.layout.ContentScale
 import androidx.compose.ui.platform.LocalContext
 import androidx.compose.ui.unit.dp
 import coil.compose.SubcomposeAsyncImage
 import coil.request.ImageRequest
 import com.example.tvmoview.MainActivity
 import com.example.tvmoview.domain.model.MediaItem
 import kotlinx.coroutines.launch
 
 @Composable
 fun ImageViewerScreen(
     currentImageId: String,
     folderId: String? = null,
     onBack: () -> Unit
 ) {
     val focusRequester = remember { FocusRequester() }
     val scope = rememberCoroutineScope()
     val context = LocalContext.current
 
     var imageItems by remember { mutableStateOf<List<MediaItem>>(emptyList()) }
     var currentIndex by remember { mutableIntStateOf(0) }
     var isLoading by remember { mutableStateOf(true) }
-    var imageUrl by remember { mutableStateOf<String?>(null) }
+    var imageUrl by remember { mutableStateOf<String?>(null) }
+    val showInfo = remember { mutableStateOf(true) }
 
     Log.d("ImageViewer", "Screen started with imageId: $currentImageId, folderId: $folderId")
 
     LaunchedEffect(folderId) {
         isLoading = true
         try {
             val items = MainActivity.oneDriveRepository.getCachedItems(folderId)
                 .filter { it.isImage }
 
             Log.d("ImageViewer", "Found ${items.size} images")
             imageItems = items
 
             val foundIndex = items.indexOfFirst { it.id == currentImageId }
             currentIndex = if (foundIndex >= 0) foundIndex else 0
 
             Log.d("ImageViewer", "Current index: $currentIndex")
 
             if (items.isNotEmpty() && currentIndex >= 0 && currentIndex < items.size) {
                 val currentItem = items[currentIndex]
                 Log.d("ImageViewer", "Loading image: ${currentItem.name}")
 
                 val url = MainActivity.oneDriveRepository
                     .getDownloadUrl(currentItem.id)
                     ?: currentItem.downloadUrl
                 imageUrl = url
                 Log.d("ImageViewer", "Image URL: $url")
             }
         } catch (e: Exception) {
             Log.e("ImageViewer", "Error loading images", e)
         } finally {
             isLoading = false
         }
     }
 
     LaunchedEffect(currentIndex) {
         if (imageItems.isNotEmpty() && currentIndex >= 0 && currentIndex < imageItems.size) {
             scope.launch {
                 val currentItem = imageItems[currentIndex]
                 Log.d("ImageViewer", "Switching to image: ${currentItem.name}")
 
                 val url = MainActivity.oneDriveRepository
                     .getDownloadUrl(currentItem.id)
                     ?: currentItem.downloadUrl
                 imageUrl = url
+                showInfo.value = true
+                scope.launch {
+                    kotlinx.coroutines.delay(3000)
+                    showInfo.value = false
+                }
             }
         }
     }
 
     LaunchedEffect(Unit) {
         focusRequester.requestFocus()
     }
 
     BackHandler { onBack() }
 
     Box(
         modifier = Modifier
             .fillMaxSize()
             .background(Color.Black)
             .focusRequester(focusRequester)
             .focusable()
             .onKeyEvent { keyEvent ->
                 if (keyEvent.type == KeyEventType.KeyDown) {
                     when (keyEvent.key) {
                         Key.DirectionLeft -> {
                             if (currentIndex > 0) {
                                 currentIndex--
                                 Log.d("ImageViewer", "Navigate left to index: $currentIndex")
                             }
                             true
@@ -111,92 +119,106 @@ fun ImageViewerScreen(
                         Key.DirectionRight -> {
                             if (currentIndex < imageItems.size - 1) {
                                 currentIndex++
                                 Log.d("ImageViewer", "Navigate right to index: $currentIndex")
                             }
                             true
                         }
                         Key.Back, Key.Escape -> {
                             Log.d("ImageViewer", "Back pressed")
                             onBack()
                             true
                         }
                         else -> false
                     }
                 } else false
             }
     ) {
         when {
             isLoading -> {
                 CircularProgressIndicator(
                     modifier = Modifier.align(Alignment.Center),
                     color = MaterialTheme.colorScheme.primary
                 )
             }
             imageUrl != null -> {
-                SubcomposeAsyncImage(
+                SubcomposeAsyncImage(
                     model = ImageRequest.Builder(context)
                         .data(imageUrl)
                         .crossfade(true)
                         .build(),
                     contentDescription = if (imageItems.isNotEmpty() && currentIndex < imageItems.size) {
                         imageItems[currentIndex].name
                     } else {
                         null
                     },
                     contentScale = ContentScale.Fit,
                     modifier = Modifier.fillMaxSize(),
                     loading = {
                         Box(
                             modifier = Modifier.fillMaxSize(),
                             contentAlignment = Alignment.Center
                         ) {
                             Column(horizontalAlignment = Alignment.CenterHorizontally) {
                                 CircularProgressIndicator(color = Color.White)
                                 Spacer(modifier = Modifier.height(16.dp))
                                 Text("ç”»åƒã‚’èª­ã¿è¾¼ã¿ä¸­...", color = Color.White)
                             }
                         }
                     },
                     error = {
                         Box(
                             modifier = Modifier.fillMaxSize(),
                             contentAlignment = Alignment.Center
                         ) {
                             Column(horizontalAlignment = Alignment.CenterHorizontally) {
                                 Icon(
                                     imageVector = Icons.Default.BrokenImage,
                                     contentDescription = "ã‚¨ãƒ©ãƒ¼",
                                     modifier = Modifier.size(64.dp),
                                     tint = Color.White
                                 )
                                 Spacer(modifier = Modifier.height(8.dp))
                                 Text("ç”»åƒã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸ", color = Color.White)
                             }
                         }
                     }
-                )
+                )
+
+                if (showInfo.value && imageItems.isNotEmpty() && currentIndex < imageItems.size) {
+                    val item = imageItems[currentIndex]
+                    val dateFormat = java.text.SimpleDateFormat("yyyy/MM/dd", java.util.Locale.getDefault())
+                    Column(
+                        modifier = Modifier
+                            .align(Alignment.TopStart)
+                            .background(Color.Black.copy(alpha = 0.6f))
+                            .padding(8.dp)
+                    ) {
+                        Text(item.name, color = Color.White, style = MaterialTheme.typography.bodyMedium)
+                        Text(dateFormat.format(item.lastModified), color = Color.White, style = MaterialTheme.typography.bodySmall)
+                    }
+                }
 
                 if (imageItems.size > 1) {
                     Row(
                         modifier = Modifier
                             .align(Alignment.BottomCenter)
                             .padding(bottom = 32.dp)
                             .background(Color.Black.copy(alpha = 0.7f))
                             .padding(horizontal = 16.dp, vertical = 8.dp),
                         horizontalArrangement = Arrangement.Center
                     ) {
                         Text(
                             text = "${currentIndex + 1} / ${imageItems.size}",
                             color = Color.White,
                             style = MaterialTheme.typography.bodyLarge
                         )
                     }
                 }
             }
             else -> {
                 Box(
                     modifier = Modifier.fillMaxSize(),
                     contentAlignment = Alignment.Center
                 ) {
                     Text("ç”»åƒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“", color = Color.White)
                 }
diff --git a/app/src/main/java/com/example/tvmoview/presentation/screens/ModernMediaBrowser.kt b/app/src/main/java/com/example/tvmoview/presentation/screens/ModernMediaBrowser.kt
index f37ffa2c2e76754e76b255851bda653abeb91c61..d13909a9eb416f1c2e9b9a699b1a718095e6939e 100644
--- a/app/src/main/java/com/example/tvmoview/presentation/screens/ModernMediaBrowser.kt
+++ b/app/src/main/java/com/example/tvmoview/presentation/screens/ModernMediaBrowser.kt
@@ -1,171 +1,203 @@
 ï»¿package com.example.tvmoview.presentation.screens
 
 import android.util.Log
 import androidx.compose.animation.*
 import androidx.compose.foundation.background
 import androidx.compose.foundation.layout.*
 import androidx.compose.material.icons.Icons
-import androidx.compose.material.icons.filled.*
-import androidx.compose.material3.*
-import androidx.compose.runtime.*
-import androidx.compose.ui.Alignment
-import androidx.compose.ui.Modifier
-import androidx.compose.ui.graphics.Brush
-import androidx.compose.ui.unit.dp
+import androidx.compose.material.icons.filled.*
+import androidx.compose.material3.*
+import androidx.compose.runtime.*
+import androidx.compose.ui.draw.rotate
+import androidx.compose.foundation.lazy.grid.*
+import androidx.compose.ui.Alignment
+import androidx.compose.ui.Modifier
+import androidx.compose.ui.graphics.Brush
+import androidx.compose.ui.unit.dp
 import androidx.lifecycle.viewmodel.compose.viewModel
 import com.example.tvmoview.MainActivity
 import com.example.tvmoview.domain.model.*
 import com.example.tvmoview.presentation.components.*
 import com.example.tvmoview.presentation.viewmodels.MediaBrowserViewModel
-import com.example.tvmoview.presentation.viewmodels.ViewMode
-import com.example.tvmoview.presentation.viewmodels.SortBy
+import com.example.tvmoview.presentation.viewmodels.ViewMode
+import com.example.tvmoview.presentation.viewmodels.SortBy
+import com.example.tvmoview.presentation.viewmodels.SortOrder
+import kotlinx.coroutines.launch
 
 @OptIn(ExperimentalMaterial3Api::class)
 @Composable
 fun ModernMediaBrowser(
     folderId: String? = null,
     onMediaSelected: (MediaItem) -> Unit,
     onFolderSelected: (String) -> Unit,
     onSettingsClick: (() -> Unit)? = null,
     onBackClick: (() -> Unit)? = null
 ) {
-    val viewModel: MediaBrowserViewModel = viewModel()
-    val items by viewModel.items.collectAsState()
-    val isLoading by viewModel.isLoading.collectAsState()
-    val viewMode by viewModel.viewMode.collectAsState()
-    val sortBy by viewModel.sortBy.collectAsState()
-    val currentPath by viewModel.currentPath.collectAsState()
+    val viewModel: MediaBrowserViewModel = viewModel()
+    val items by viewModel.items.collectAsState()
+    val isLoading by viewModel.isLoading.collectAsState()
+    val viewMode by viewModel.viewMode.collectAsState()
+    val sortBy by viewModel.sortBy.collectAsState()
+    val sortOrder by viewModel.sortOrder.collectAsState()
+    val tileColumns by viewModel.tileColumns.collectAsState()
+    val currentPath by viewModel.currentPath.collectAsState()
 
-    var showSortDialog by remember { mutableStateOf(false) }
+    var showSortDialog by remember { mutableStateOf(false) }
+    val gridState = rememberLazyGridState()
+    val coroutineScope = rememberCoroutineScope()
 
     // OneDriveçµ±åˆï¼šãƒ‡ãƒ¼ã‚¿å–å¾—å‡¦ç†
     LaunchedEffect(folderId) {
         Log.d("ModernMediaBrowser", "ğŸ“ ãƒ•ã‚©ãƒ«ãƒ€èª­ã¿è¾¼ã¿é–‹å§‹: $folderId")
         viewModel.loadItems(folderId)
     }
 
     Box(
         modifier = Modifier
             .fillMaxSize()
             .background(
                 Brush.verticalGradient(
                     colors = listOf(
                         MaterialTheme.colorScheme.background,
                         MaterialTheme.colorScheme.surface
                     )
                 )
             )
     ) {
         Column {
-            ModernTopBar(
-                currentPath = currentPath,
-                viewMode = viewMode,
-                onViewModeChange = { viewModel.toggleViewMode() },
-                onSortClick = { showSortDialog = true },
-                onRefreshClick = { viewModel.refresh() },
-                onSettingsClick = onSettingsClick,
-                onBackClick = onBackClick,
-                isLoading = isLoading
-            )
+            ModernTopBar(
+                currentPath = currentPath,
+                viewMode = viewMode,
+                sortOrder = sortOrder,
+                tileColumns = tileColumns,
+                onViewModeChange = { viewModel.toggleViewMode() },
+                onTileColumnsChange = { viewModel.cycleTileColumns() },
+                onSortClick = { showSortDialog = true },
+                onOrderToggle = { viewModel.setSortOrder(if (sortOrder == SortOrder.ASC) SortOrder.DESC else SortOrder.ASC) },
+                onRefreshClick = { viewModel.refresh() },
+                onSettingsClick = onSettingsClick,
+                onBackClick = onBackClick,
+                isLoading = isLoading
+            )
 
             Box(modifier = Modifier.fillMaxSize()) {
                 when {
                     // åˆå›èª­ã¿è¾¼ã¿æ™‚ã®ã¿ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºï¼ˆãƒ‡ãƒ¼ã‚¿ãŒãªã„ + èª­ã¿è¾¼ã¿ä¸­ï¼‰
                     isLoading && items.isEmpty() -> LoadingAnimation()
 
                     // ãƒ‡ãƒ¼ã‚¿ãŒç©ºã§ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­ã§ãªã„å ´åˆ
                     items.isEmpty() && !isLoading -> EmptyStateView()
 
                     // ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆã¯å¸¸ã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¡¨ç¤ºï¼ˆæ‰‹å‹•æ›´æ–°ä¸­ã§ã‚‚è¡¨ç¤ºç¶™ç¶šï¼‰
                     else -> {
                         when (viewMode) {
                             ViewMode.TILE -> {
-                                ModernTileView(
-                                    items = items,
-                                    onItemClick = { item ->
-                                        if (item.isFolder) {
-                                            Log.d("ModernMediaBrowser", "ğŸ“‚ ãƒ•ã‚©ãƒ«ãƒ€é¸æŠ: ${item.name}")
-                                            onFolderSelected(item.id)
-                                        } else {
+                                ModernTileView(
+                                    items = items,
+                                    columnCount = tileColumns,
+                                    state = gridState,
+                                    onItemClick = { item ->
+                                        if (item.isFolder) {
+                                            Log.d("ModernMediaBrowser", "ğŸ“‚ ãƒ•ã‚©ãƒ«ãƒ€é¸æŠ: ${item.name}")
+                                            onFolderSelected(item.id)
+                                        } else {
                                             Log.d("ModernMediaBrowser", "ğŸ¬ ãƒ¡ãƒ‡ã‚£ã‚¢é¸æŠ: ${item.name}")
                                             Log.d("ModernMediaBrowser", "ğŸ“Š downloadUrl: ${item.downloadUrl}")
                                             onMediaSelected(item)
                                         }
-                                    }
-                                )
-                            }
-                            ViewMode.LIST -> {
+                                    }
+                                )
+                                if (sortBy == SortBy.SHOOT) {
+                                    Slider(
+                                        modifier = Modifier
+                                            .align(Alignment.CenterEnd)
+                                            .height(200.dp)
+                                            .rotate(90f),
+                                        value = gridState.firstVisibleItemIndex.toFloat(),
+                                        onValueChange = {
+                                            coroutineScope.launch {
+                                                gridState.scrollToItem(it.toInt())
+                                            }
+                                        },
+                                        valueRange = 0f..(items.size - 1).coerceAtLeast(0).toFloat(),
+                                        steps = (items.size - 2).coerceAtLeast(0)
+                                    )
+                                }
+                            }
+                            ViewMode.LIST -> {
                                 ModernListView(
                                     items = items,
                                     onItemClick = { item ->
                                         if (item.isFolder) {
                                             Log.d("ModernMediaBrowser", "ğŸ“‚ ãƒ•ã‚©ãƒ«ãƒ€é¸æŠ: ${item.name}")
                                             onFolderSelected(item.id)
                                         } else {
                                             Log.d("ModernMediaBrowser", "ğŸ¬ ãƒ¡ãƒ‡ã‚£ã‚¢é¸æŠ: ${item.name}")
                                             Log.d("ModernMediaBrowser", "ğŸ“Š downloadUrl: ${item.downloadUrl}")
                                             onMediaSelected(item)
                                         }
                                     }
                                 )
                             }
                         }
                     }
                 }
 
                 // OneDriveçµ±åˆçŠ¶æ…‹è¡¨ç¤ºï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
                 if (MainActivity.authManager.isAuthenticated()) {
                     Card(
                         modifier = Modifier
                             .align(Alignment.BottomEnd)
                             .padding(16.dp),
                         colors = CardDefaults.cardColors(
                             containerColor = MaterialTheme.colorScheme.primary.copy(alpha = 0.8f)
                         )
                     ) {
                         Text(
                             text = "ğŸ” OneDriveæ¥ç¶šä¸­",
                             color = MaterialTheme.colorScheme.onPrimary,
                             style = MaterialTheme.typography.bodySmall,
                             modifier = Modifier.padding(8.dp)
                         )
                     }
                 }
             }
         }
 
-        if (showSortDialog) {
-            SortDialog(
-                currentSort = sortBy,
-                onSortSelected = { sort ->
-                    viewModel.setSortBy(sort)
-                    showSortDialog = false
-                },
-                onDismiss = { showSortDialog = false }
-            )
-        }
+        if (showSortDialog) {
+            SortDialog(
+                currentSort = sortBy,
+                currentOrder = sortOrder,
+                onSortSelected = { sort ->
+                    viewModel.setSortBy(sort)
+                    showSortDialog = false
+                },
+                onOrderSelected = { order -> viewModel.setSortOrder(order) },
+                onDismiss = { showSortDialog = false }
+            )
+        }
     }
 }
 
 @Composable
 fun LoadingAnimation() {
     Box(
         modifier = Modifier.fillMaxSize(),
         contentAlignment = Alignment.Center
     ) {
         Column(
             horizontalAlignment = Alignment.CenterHorizontally
         ) {
             CircularProgressIndicator()
             Spacer(modifier = Modifier.height(16.dp))
             Text("OneDriveã‹ã‚‰èª­ã¿è¾¼ã¿ä¸­...")
         }
     }
 }
 
 @Composable
 fun EmptyStateView() {
     Box(
         modifier = Modifier.fillMaxSize(),
         contentAlignment = Alignment.Center
     ) {
@@ -195,43 +227,44 @@ fun EmptyStateView() {
 
 @Composable
 fun SortDialog(
     currentSort: SortBy,
     onSortSelected: (SortBy) -> Unit,
     onDismiss: () -> Unit
 ) {
     AlertDialog(
         onDismissRequest = onDismiss,
         title = { Text("ä¸¦ã³é †") },
         text = {
             Column {
                 SortBy.values().forEach { sortOption ->
                     Row(
                         modifier = Modifier
                             .fillMaxWidth()
                             .padding(vertical = 4.dp),
                         verticalAlignment = Alignment.CenterVertically
                     ) {
                         RadioButton(
                             selected = currentSort == sortOption,
                             onClick = { onSortSelected(sortOption) }
                         )
                         Spacer(modifier = Modifier.width(8.dp))
                         Text(
-                            text = when (sortOption) {
-                                SortBy.NAME -> "åå‰é †"
-                                SortBy.DATE -> "æ›´æ–°æ—¥æ™‚é †"
-                                SortBy.SIZE -> "ã‚µã‚¤ã‚ºé †"
-                                SortBy.TYPE -> "ç¨®é¡é †"
-                            }
+                            text = when (sortOption) {
+                                SortBy.NAME -> "åå‰é †"
+                                SortBy.DATE -> "æ›´æ–°æ—¥æ™‚é †"
+                                SortBy.SIZE -> "ã‚µã‚¤ã‚ºé †"
+                                SortBy.TYPE -> "ç¨®é¡é †"
+                                SortBy.SHOOT -> "æ’®å½±æ—¥é †"
+                            }
                         )
                     }
                 }
             }
         },
         confirmButton = {
             TextButton(onClick = onDismiss) {
                 Text("é–‰ã˜ã‚‹")
             }
         }
     )
 }
\ No newline at end of file
diff --git a/app/src/main/java/com/example/tvmoview/presentation/viewmodels/MediaBrowserViewModel.kt b/app/src/main/java/com/example/tvmoview/presentation/viewmodels/MediaBrowserViewModel.kt
index 95a42ff3dedabeb8426f646122e66eba77d6a09a..b5261ad94b15f33ae80f0cdbc25f470cded02ba7 100644
--- a/app/src/main/java/com/example/tvmoview/presentation/viewmodels/MediaBrowserViewModel.kt
+++ b/app/src/main/java/com/example/tvmoview/presentation/viewmodels/MediaBrowserViewModel.kt
@@ -1,106 +1,121 @@
 ï»¿package com.example.tvmoview.presentation.viewmodels
 
 import android.util.Log
 import androidx.lifecycle.ViewModel
 import androidx.lifecycle.viewModelScope
 import kotlinx.coroutines.flow.MutableStateFlow
 import kotlinx.coroutines.flow.StateFlow
 import kotlinx.coroutines.flow.asStateFlow
 import kotlinx.coroutines.Job
 import kotlinx.coroutines.launch
 import com.example.tvmoview.domain.model.MediaItem
-import com.example.tvmoview.MainActivity
-import java.util.Date
+import com.example.tvmoview.MainActivity
+import com.example.tvmoview.data.prefs.UserPreferences
+import java.util.Date
 
 enum class ViewMode {
     TILE, LIST
 }
 
-enum class SortBy {
-    NAME, DATE, SIZE, TYPE
-}
+enum class SortBy {
+    NAME, DATE, SIZE, TYPE, SHOOT
+}
+
+enum class SortOrder {
+    ASC, DESC
+}
 
 class MediaBrowserViewModel : ViewModel() {
 
     private val _items = MutableStateFlow<List<MediaItem>>(emptyList())
     val items: StateFlow<List<MediaItem>> = _items.asStateFlow()
 
     private val _isLoading = MutableStateFlow(false)
     val isLoading: StateFlow<Boolean> = _isLoading.asStateFlow()
 
     private val _viewMode = MutableStateFlow(ViewMode.TILE)
     val viewMode: StateFlow<ViewMode> = _viewMode.asStateFlow()
 
-    private val _sortBy = MutableStateFlow(SortBy.NAME)
-    val sortBy: StateFlow<SortBy> = _sortBy.asStateFlow()
+    private val _sortBy = MutableStateFlow(SortBy.valueOf(UserPreferences.sortBy))
+    val sortBy: StateFlow<SortBy> = _sortBy.asStateFlow()
+
+    private val _sortOrder = MutableStateFlow(SortOrder.valueOf(UserPreferences.sortOrder))
+    val sortOrder: StateFlow<SortOrder> = _sortOrder.asStateFlow()
+
+    private val _tileColumns = MutableStateFlow(UserPreferences.tileColumns)
+    val tileColumns: StateFlow<Int> = _tileColumns.asStateFlow()
 
     private val _currentPath = MutableStateFlow("OneDrive")
     val currentPath: StateFlow<String> = _currentPath.asStateFlow()
 
     private val _currentFolderId = MutableStateFlow<String?>(null)
     val currentFolderId: StateFlow<String?> = _currentFolderId.asStateFlow()
 
     private var loadJob: Job? = null
 
     fun loadItems(folderId: String? = null, force: Boolean = false) {
         loadJob?.cancel()
         _currentFolderId.value = folderId
         _currentPath.value = if (folderId != null) {
             MainActivity.oneDriveRepository.getCurrentPath(folderId)
         } else {
             "OneDrive"
         }
 
         Log.d(
             "MediaBrowserViewModel",
             "loadItems(folder=${folderId ?: "root"}, force=$force)"
         )
 
-        loadJob = viewModelScope.launch {
-            // ã¾ãšã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å³åº§ã«è¡¨ç¤º
-            val cachedItems = MainActivity.oneDriveRepository.getCachedItems(folderId)
-            if (cachedItems.isNotEmpty()) {
-                _items.value = applySorting(cachedItems)
-                _isLoading.value = false
-                Log.d("MediaBrowserViewModel", "Showing ${cachedItems.size} cached items immediately")
-            } else {
-                _isLoading.value = true
-            }
+        loadJob = viewModelScope.launch {
+            val limit = 30
+            val cachedItems = MainActivity.oneDriveRepository.getCachedItems(folderId)
+            if (cachedItems.isNotEmpty()) {
+                val sorted = applySorting(cachedItems)
+                _items.value = sorted.take(limit)
+                _isLoading.value = false
+                launch { _items.value = sorted }
+                Log.d("MediaBrowserViewModel", "Showing ${cachedItems.size} cached items immediately")
+            } else {
+                _isLoading.value = true
+            }
 
             // OneDriveçµ±åˆã®å ´åˆ
-            if (MainActivity.authManager.isAuthenticated()) {
-                MainActivity.oneDriveRepository.getFolderItems(folderId, force).collect { list ->
-                    _items.value = applySorting(list)
-                    if (_isLoading.value) {
-                        _isLoading.value = false
-                    }
-                    Log.d(
-                        "MediaBrowserViewModel",
-                        "items updated: ${list.size} entries"
-                    )
-                }
+            if (MainActivity.authManager.isAuthenticated()) {
+                MainActivity.oneDriveRepository.getFolderItems(folderId, force).collect { list ->
+                    val sorted = applySorting(list)
+                    _items.value = sorted.take(limit)
+                    launch { _items.value = sorted }
+                    if (_isLoading.value) {
+                        _isLoading.value = false
+                    }
+                    Log.d(
+                        "MediaBrowserViewModel",
+                        "items updated: ${list.size} entries"
+                    )
+                }
             } else {
                 // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®å ´åˆ
                 val items = loadTestItems(folderId)
                 _items.value = applySorting(items)
                 _isLoading.value = false
             }
         }
     }
 
     private fun loadTestItems(folderId: String?): List<MediaItem> {
         return try {
             // MediaRepositoryã®æ­£ã—ã„ãƒ¡ã‚½ãƒƒãƒ‰åã‚’ä½¿ç”¨
             if (folderId != null) {
                 // ãƒ•ã‚©ãƒ«ãƒ€æŒ‡å®šã®å ´åˆï¼ˆä»®å®Ÿè£…ï¼šç©ºãƒªã‚¹ãƒˆï¼‰
                 emptyList()
             } else {
                 // ãƒ«ãƒ¼ãƒˆã®å ´åˆï¼šãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
                 generateTestMediaItems()
             }
         } catch (e: Exception) {
             Log.e("MediaBrowserViewModel", "âŒ ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿å–å¾—å¤±æ•—", e)
             emptyList()
         }
     }
 
@@ -112,95 +127,127 @@ class MediaBrowserViewModel : ViewModel() {
                 name = "ã‚µãƒ³ãƒ—ãƒ«å‹•ç”»1.mp4",
                 size = 125829120,
                 mimeType = "video/mp4",
                 isFolder = false,
                 downloadUrl = null
             ),
             MediaItem(
                 id = "test_video_2",
                 name = "ã‚µãƒ³ãƒ—ãƒ«å‹•ç”»2.mp4",
                 size = 89654321,
                 mimeType = "video/mp4",
                 isFolder = false,
                 downloadUrl = null
             ),
             MediaItem(
                 id = "test_folder_1",
                 name = "ã‚µãƒ³ãƒ—ãƒ«ãƒ•ã‚©ãƒ«ãƒ€",
                 size = 0,
                 mimeType = null,
                 isFolder = true,
                 downloadUrl = null
             )
         )
     }
 
-    fun toggleViewMode() {
-        _viewMode.value = when (_viewMode.value) {
-            ViewMode.TILE -> ViewMode.LIST
-            ViewMode.LIST -> ViewMode.TILE
-        }
-        Log.d("MediaBrowserViewModel", "ğŸ¨ è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰å¤‰æ›´: ${_viewMode.value}")
-    }
-
-    fun setSortBy(sortBy: SortBy) {
-        _sortBy.value = sortBy
-
-        // ç¾åœ¨ã®ã‚¢ã‚¤ãƒ†ãƒ ã«æ–°ã—ã„ã‚½ãƒ¼ãƒˆã‚’é©ç”¨
-        val currentItems = _items.value
-        val sortedItems = applySorting(currentItems)
-        _items.value = sortedItems
-
-        Log.d("MediaBrowserViewModel", "ğŸ”€ ã‚½ãƒ¼ãƒˆå¤‰æ›´: $sortBy")
-    }
-
-    private fun applySorting(items: List<MediaItem>): List<MediaItem> {
-        return when (_sortBy.value) {
-            SortBy.NAME -> items.sortedBy { it.name.lowercase() }
-            SortBy.DATE -> items.sortedByDescending { it.lastModified }
-            SortBy.SIZE -> items.sortedByDescending { it.size }
-            SortBy.TYPE -> items.sortedWith(
-                compareBy<MediaItem> { !it.isFolder }
-                    .thenBy { it.mimeType ?: "" }
-                    .thenBy { it.name.lowercase() }
-            )
-        }
-    }
+    fun toggleViewMode() {
+        _viewMode.value = when (_viewMode.value) {
+            ViewMode.TILE -> ViewMode.LIST
+            ViewMode.LIST -> ViewMode.TILE
+        }
+        Log.d("MediaBrowserViewModel", "ğŸ¨ è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰å¤‰æ›´: ${_viewMode.value}")
+    }
+
+    fun cycleTileColumns() {
+        val next = when (_tileColumns.value) {
+            4 -> 6
+            6 -> 8
+            else -> 4
+        }
+        _tileColumns.value = next
+        UserPreferences.tileColumns = next
+    }
+
+    fun setSortBy(sortBy: SortBy) {
+        _sortBy.value = sortBy
+        UserPreferences.sortBy = sortBy.name
+
+        // ç¾åœ¨ã®ã‚¢ã‚¤ãƒ†ãƒ ã«æ–°ã—ã„ã‚½ãƒ¼ãƒˆã‚’é©ç”¨
+        val currentItems = _items.value
+        val sortedItems = applySorting(currentItems)
+        _items.value = sortedItems
+
+        Log.d("MediaBrowserViewModel", "ğŸ”€ ã‚½ãƒ¼ãƒˆå¤‰æ›´: $sortBy")
+    }
+
+    fun setSortOrder(order: SortOrder) {
+        _sortOrder.value = order
+        UserPreferences.sortOrder = order.name
+        val currentItems = _items.value
+        _items.value = applySorting(currentItems)
+    }
+
+    private fun applySorting(items: List<MediaItem>): List<MediaItem> {
+        val sorted = when (_sortBy.value) {
+            SortBy.NAME -> items.sortedWith(
+                compareBy<MediaItem> { !it.isFolder }
+                    .thenBy { it.name.lowercase() }
+            )
+            SortBy.DATE -> items.sortedWith(
+                compareBy<MediaItem> { !it.isFolder }
+                    .thenBy { it.lastModified }
+            )
+            SortBy.SIZE -> items.sortedWith(
+                compareBy<MediaItem> { !it.isFolder }
+                    .thenBy { it.size }
+            )
+            SortBy.TYPE -> items.sortedWith(
+                compareBy<MediaItem> { !it.isFolder }
+                    .thenBy { it.mimeType ?: "" }
+                    .thenBy { it.name.lowercase() }
+            )
+            SortBy.SHOOT -> items.sortedWith(
+                compareBy<MediaItem> { !it.isFolder }
+                    .thenBy { it.lastModified }
+            )
+        }
+        return if (_sortOrder.value == SortOrder.DESC) sorted.reversed() else sorted
+    }
 
     fun refresh() {
         Log.d("MediaBrowserViewModel", "ğŸ”„ ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ›´æ–°é–‹å§‹")
 
         // TOPãƒãƒ¼ã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã®ã¿é–‹å§‹ï¼ˆç”»é¢è¡¨ç¤ºã¯ç¶­æŒï¼‰
         _isLoading.value = true
 
         loadJob?.cancel()
         loadJob = viewModelScope.launch {
             try {
                 Log.d("MediaBrowserViewModel", "ğŸŒ ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†é–‹å§‹")
 
                 // OneDriveçµ±åˆã®å ´åˆ
-                if (MainActivity.authManager.isAuthenticated()) {
-                    // force=true ã§ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ›´æ–°
-                    MainActivity.oneDriveRepository.getFolderItems(_currentFolderId.value, force = true).collect { newList ->
-                        // æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ããŸæ™‚ã®ã¿ç”»é¢æ›´æ–°
-                        if (newList.isNotEmpty() || _items.value.isEmpty()) {
-                            _items.value = applySorting(newList)
-                            Log.d("MediaBrowserViewModel", "âœ… ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ›´æ–°å®Œäº†: ${newList.size} entries")
-                        }
-
-                        // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹çµ‚äº†
-                        _isLoading.value = false
-                    }
-                } else {
-                    // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®å ´åˆ
-                    val items = loadTestItems(_currentFolderId.value)
-                    _items.value = applySorting(items)
-                    _isLoading.value = false
-                    Log.d("MediaBrowserViewModel", "âœ… ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æ›´æ–°å®Œäº†")
-                }
+                if (MainActivity.authManager.isAuthenticated()) {
+                    MainActivity.oneDriveRepository.getFolderItems(_currentFolderId.value, force = true).collect { newList ->
+                        val sorted = applySorting(newList)
+                        if (newList.isNotEmpty() || _items.value.isEmpty()) {
+                            _items.value = sorted.take(30)
+                            launch { _items.value = sorted }
+                            Log.d("MediaBrowserViewModel", "âœ… ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ›´æ–°å®Œäº†: ${newList.size} entries")
+                        }
+
+                        _isLoading.value = false
+                    }
+                } else {
+                    val items = loadTestItems(_currentFolderId.value)
+                    val sorted = applySorting(items)
+                    _items.value = sorted.take(30)
+                    launch { _items.value = sorted }
+                    _isLoading.value = false
+                    Log.d("MediaBrowserViewModel", "âœ… ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æ›´æ–°å®Œäº†")
+                }
             } catch (e: Exception) {
                 Log.e("MediaBrowserViewModel", "âŒ ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ›´æ–°ã‚¨ãƒ©ãƒ¼", e)
                 _isLoading.value = false
             }
         }
     }
 }
\ No newline at end of file
diff --git a/build.gradle.kts b/build.gradle.kts
index 20dd7b236e30b283344ac42b1c60733e83e08284..333640368f8b2246896ea366e98106649cb49c06 100644
--- a/build.gradle.kts
+++ b/build.gradle.kts
@@ -1,7 +1,7 @@
 // Top-level build file where you can add configuration options common to all sub-projects/modules.
 plugins {
     id("com.android.application") version "8.2.0" apply false
     id("org.jetbrains.kotlin.android") version "2.0.0" apply false
     id("org.jetbrains.kotlin.plugin.compose") version "2.0.0" apply false
-    id("org.jetbrains.kotlin.kapt") version "2.0.0" apply false
-}
\ No newline at end of file
+    id("com.google.devtools.ksp") version "2.0.20-1.0.21" apply false
+}
diff --git a/gradle/libs.versions.toml b/gradle/libs.versions.toml
index f21f561d8c3e3da34ed581b3a4c75defcc4c4205..8b5bf09864a2d89b7b0703d8054b1bb784653a6e 100644
--- a/gradle/libs.versions.toml
+++ b/gradle/libs.versions.toml
@@ -1,32 +1,60 @@
 [versions]
-agp = "8.10.1"
-kotlin = "2.0.21"
-coreKtx = "1.16.0"
+agp = "8.2.0"
+kotlin = "2.0.0"
+coreKtx = "1.12.0"
 junit = "4.13.2"
 junitVersion = "1.2.1"
 espressoCore = "3.6.1"
-lifecycleRuntimeKtx = "2.9.1"
-activityCompose = "1.10.1"
-composeBom = "2024.09.00"
+lifecycleRuntimeKtx = "2.7.0"
+activityCompose = "1.8.2"
+composeBom = "2024.02.00"
+navigationCompose = "2.7.6"
+coroutines = "1.7.3"
+coil = "2.5.0"
+room = "2.6.1"
+media3 = "1.2.1"
+okhttp = "4.12.0"
+retrofit = "2.9.0"
+gson = "2.8.9"
+tvFoundation = "1.0.0-alpha10"
 
 [libraries]
 androidx-core-ktx = { group = "androidx.core", name = "core-ktx", version.ref = "coreKtx" }
 junit = { group = "junit", name = "junit", version.ref = "junit" }
 androidx-junit = { group = "androidx.test.ext", name = "junit", version.ref = "junitVersion" }
 androidx-espresso-core = { group = "androidx.test.espresso", name = "espresso-core", version.ref = "espressoCore" }
 androidx-lifecycle-runtime-ktx = { group = "androidx.lifecycle", name = "lifecycle-runtime-ktx", version.ref = "lifecycleRuntimeKtx" }
 androidx-activity-compose = { group = "androidx.activity", name = "activity-compose", version.ref = "activityCompose" }
 androidx-compose-bom = { group = "androidx.compose", name = "compose-bom", version.ref = "composeBom" }
 androidx-ui = { group = "androidx.compose.ui", name = "ui" }
 androidx-ui-graphics = { group = "androidx.compose.ui", name = "ui-graphics" }
 androidx-ui-tooling = { group = "androidx.compose.ui", name = "ui-tooling" }
 androidx-ui-tooling-preview = { group = "androidx.compose.ui", name = "ui-tooling-preview" }
 androidx-ui-test-manifest = { group = "androidx.compose.ui", name = "ui-test-manifest" }
 androidx-ui-test-junit4 = { group = "androidx.compose.ui", name = "ui-test-junit4" }
 androidx-material3 = { group = "androidx.compose.material3", name = "material3" }
+androidx-navigation-compose = { group = "androidx.navigation", name = "navigation-compose", version.ref = "navigationCompose" }
+kotlinx-coroutines-android = { group = "org.jetbrains.kotlinx", name = "kotlinx-coroutines-android", version.ref = "coroutines" }
+androidx-tv-foundation = { group = "androidx.tv", name = "tv-foundation", version.ref = "tvFoundation" }
+androidx-tv-material = { group = "androidx.tv", name = "tv-material", version.ref = "tvFoundation" }
+androidx-leanback = { group = "androidx.leanback", name = "leanback", version = "1.0.0" }
+androidx-media3-exoplayer = { group = "androidx.media3", name = "media3-exoplayer", version.ref = "media3" }
+androidx-media3-ui = { group = "androidx.media3", name = "media3-ui", version.ref = "media3" }
+androidx-media3-common = { group = "androidx.media3", name = "media3-common", version.ref = "media3" }
+coil-compose = { group = "io.coil-kt", name = "coil-compose", version.ref = "coil" }
+coil = { group = "io.coil-kt", name = "coil", version.ref = "coil" }
+androidx-room-runtime = { group = "androidx.room", name = "room-runtime", version.ref = "room" }
+androidx-room-ktx = { group = "androidx.room", name = "room-ktx", version.ref = "room" }
+androidx-room-compiler = { group = "androidx.room", name = "room-compiler", version.ref = "room" }
+okhttp = { group = "com.squareup.okhttp3", name = "okhttp", version.ref = "okhttp" }
+okhttp-logging = { group = "com.squareup.okhttp3", name = "logging-interceptor", version.ref = "okhttp" }
+retrofit = { group = "com.squareup.retrofit2", name = "retrofit", version.ref = "retrofit" }
+retrofit-converter-gson = { group = "com.squareup.retrofit2", name = "converter-gson", version.ref = "retrofit" }
+gson = { group = "com.google.code.gson", name = "gson", version.ref = "gson" }
 
 [plugins]
 android-application = { id = "com.android.application", version.ref = "agp" }
 kotlin-android = { id = "org.jetbrains.kotlin.android", version.ref = "kotlin" }
 kotlin-compose = { id = "org.jetbrains.kotlin.plugin.compose", version.ref = "kotlin" }
+ksp = { id = "com.google.devtools.ksp", version = "2.0.20-1.0.21" }
 
diff --git a/gradle/libs.versions.toml.rej b/gradle/libs.versions.toml.rej
deleted file mode 100644
index 7e7b786285a435ffb7878293b9e8c766973d9de1..0000000000000000000000000000000000000000
--- a/gradle/libs.versions.toml.rej
+++ /dev/null
@@ -1,67 +0,0 @@
-diff a/gradle/libs.versions.toml b/gradle/libs.versions.toml	(rejected hunks)
-@@ -1,32 +1,59 @@
- [versions]
--agp = "8.10.1"
--kotlin = "2.0.21"
--coreKtx = "1.16.0"
-+agp = "8.2.0"
-+kotlin = "2.0.0"
-+coreKtx = "1.12.0"
- junit = "4.13.2"
- junitVersion = "1.2.1"
- espressoCore = "3.6.1"
--lifecycleRuntimeKtx = "2.9.1"
--activityCompose = "1.10.1"
--composeBom = "2024.09.00"
-+lifecycleRuntimeKtx = "2.7.0"
-+activityCompose = "1.8.2"
-+composeBom = "2024.02.00"
-+navigationCompose = "2.7.6"
-+coroutines = "1.7.3"
-+coil = "2.5.0"
-+room = "2.6.1"
-+media3 = "1.2.1"
-+okhttp = "4.12.0"
-+retrofit = "2.9.0"
-+gson = "2.8.9"
-+tvFoundation = "1.0.0-alpha10"
- 
- [libraries]
- androidx-core-ktx = { group = "androidx.core", name = "core-ktx", version.ref = "coreKtx" }
- junit = { group = "junit", name = "junit", version.ref = "junit" }
- androidx-junit = { group = "androidx.test.ext", name = "junit", version.ref = "junitVersion" }
- androidx-espresso-core = { group = "androidx.test.espresso", name = "espresso-core", version.ref = "espressoCore" }
- androidx-lifecycle-runtime-ktx = { group = "androidx.lifecycle", name = "lifecycle-runtime-ktx", version.ref = "lifecycleRuntimeKtx" }
- androidx-activity-compose = { group = "androidx.activity", name = "activity-compose", version.ref = "activityCompose" }
- androidx-compose-bom = { group = "androidx.compose", name = "compose-bom", version.ref = "composeBom" }
- androidx-ui = { group = "androidx.compose.ui", name = "ui" }
- androidx-ui-graphics = { group = "androidx.compose.ui", name = "ui-graphics" }
- androidx-ui-tooling = { group = "androidx.compose.ui", name = "ui-tooling" }
- androidx-ui-tooling-preview = { group = "androidx.compose.ui", name = "ui-tooling-preview" }
- androidx-ui-test-manifest = { group = "androidx.compose.ui", name = "ui-test-manifest" }
- androidx-ui-test-junit4 = { group = "androidx.compose.ui", name = "ui-test-junit4" }
- androidx-material3 = { group = "androidx.compose.material3", name = "material3" }
-+androidx-navigation-compose = { group = "androidx.navigation", name = "navigation-compose", version.ref = "navigationCompose" }
-+kotlinx-coroutines-android = { group = "org.jetbrains.kotlinx", name = "kotlinx-coroutines-android", version.ref = "coroutines" }
-+androidx-tv-foundation = { group = "androidx.tv", name = "tv-foundation", version.ref = "tvFoundation" }
-+androidx-tv-material = { group = "androidx.tv", name = "tv-material", version.ref = "tvFoundation" }
-+androidx-leanback = { group = "androidx.leanback", name = "leanback", version = "1.0.0" }
-+androidx-media3-exoplayer = { group = "androidx.media3", name = "media3-exoplayer", version.ref = "media3" }
-+androidx-media3-ui = { group = "androidx.media3", name = "media3-ui", version.ref = "media3" }
-+androidx-media3-common = { group = "androidx.media3", name = "media3-common", version.ref = "media3" }
-+coil-compose = { group = "io.coil-kt", name = "coil-compose", version.ref = "coil" }
-+androidx-room-runtime = { group = "androidx.room", name = "room-runtime", version.ref = "room" }
-+androidx-room-ktx = { group = "androidx.room", name = "room-ktx", version.ref = "room" }
-+androidx-room-compiler = { group = "androidx.room", name = "room-compiler", version.ref = "room" }
-+okhttp = { group = "com.squareup.okhttp3", name = "okhttp", version.ref = "okhttp" }
-+okhttp-logging = { group = "com.squareup.okhttp3", name = "logging-interceptor", version.ref = "okhttp" }
-+retrofit = { group = "com.squareup.retrofit2", name = "retrofit", version.ref = "retrofit" }
-+retrofit-converter-gson = { group = "com.squareup.retrofit2", name = "converter-gson", version.ref = "retrofit" }
-+gson = { group = "com.google.code.gson", name = "gson", version.ref = "gson" }
- 
- [plugins]
- android-application = { id = "com.android.application", version.ref = "agp" }
- kotlin-android = { id = "org.jetbrains.kotlin.android", version.ref = "kotlin" }
- kotlin-compose = { id = "org.jetbrains.kotlin.plugin.compose", version.ref = "kotlin" }
-+kotlin-kapt = { id = "org.jetbrains.kotlin.kapt", version.ref = "kotlin" }
- 
diff --git a/settings.gradle.kts b/settings.gradle.kts
index 7a8a435094931273d59a036dcd30316ba464e721..9f54c13348b9096730534eb62b0d7003c10f94aa 100644
--- a/settings.gradle.kts
+++ b/settings.gradle.kts
@@ -1,24 +1,18 @@
 pluginManagement {
     repositories {
-        google {
-            content {
-                includeGroupByRegex("com\\.android.*")
-                includeGroupByRegex("com\\.google.*")
-                includeGroupByRegex("androidx.*")
-            }
-        }
+        google()
         mavenCentral()
         gradlePluginPortal()
     }
 }
 dependencyResolutionManagement {
     repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
     repositories {
         google()
         mavenCentral()
     }
 }
 
 rootProject.name = "tv moview"
 include(":app")
  
\ No newline at end of file
diff --git "a/\351\226\213\347\231\272\344\276\235\351\240\274\343\203\253\343\203\274\343\203\253.md" "b/\351\226\213\347\231\272\344\276\235\351\240\274\343\203\253\343\203\274\343\203\253.md"
index d144ac543c84687cecf8cb9ca69d24eed8ab60e4..73315c015efcf7f2ecdf657758dc2d0d0b369aa2 100644
--- "a/\351\226\213\347\231\272\344\276\235\351\240\274\343\203\253\343\203\274\343\203\253.md"
+++ "b/\351\226\213\347\231\272\344\276\235\351\240\274\343\203\253\343\203\274\343\203\253.md"
@@ -38,64 +38,64 @@
 |                               | Compose Compiler                    | 2.0.0               |
 | Android SDK                | minSdk / targetSdk                  | 26 / 34             |
 | UI                          | Jetpack Compose BOM                 | 2024.02.00ï¼ˆBOMï¼‰   |
 |                               | Compose UI                         | BOMæº–æ‹              |
 |                               | Material3                          | 1.2.0               |
 |                               | Compose for TV                     | 1.0.0-alpha10       |
 | ç”»åƒ                         | Coil                                | 2.5.0               |
 | å‹•ç”»                         | ExoPlayerï¼ˆandroidx.media3ï¼‰        | 1.2.1               |
 | OneDriveé€£æº                | Microsoft Graph Java SDK            | 6.0.0               |
 | èªè¨¼                         | MSAL                                | æœ€æ–°å®‰å®šç‰ˆ          |
 | é€šä¿¡                         | Retrofit                            | 2.9.0               |
 |                               | OkHttp                              | 4.12.0              |
 | JSON                        | Gson                                | 2.8.9               |
 | DB                          | Room                                | 2.6.1               |
 | ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³               | Navigation-Compose                  | 2.7.6               |
 | Activityã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ        | androidx.activity:*                 | 1.8.2               |
 | ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†            | androidx.lifecycle:*                | 2.7.0               |
 | ã‚³ãƒ«ãƒ¼ãƒãƒ³                   | kotlinx-coroutines-*                | 1.7.3               |
 | ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³æ“ä½œ             | androidx.collection:*               | 1.4.0               |
 | ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³é–¢é€£            | androidx.annotation:*               | 1.7.0               |
 
 ---
 
 ## ğŸ› ï¸ Kotlin Symbol Processing (KSP) ã®ä½¿ç”¨æ–¹é‡
 
-- KSP ã¯ `2.0.0-1.0.20` ã‚’æ¨™æº–ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨ã™ã‚‹ï¼ˆKotlin 2.0.0 + Compose 2024ç³»ã¨æ•´åˆï¼‰
+ - KSP ã¯ `2.0.20-1.0.21` ã‚’æ¨™æº–ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨ã™ã‚‹ï¼ˆKotlin 2.0.0 + Compose 2024ç³»ã¨æ•´åˆï¼‰
 - `pluginManagement` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã« `google()` ãŠã‚ˆã³ `mavenCentral()` ã‚’æ˜è¨˜ã—ã€KSPè§£æ±ºã‚¨ãƒ©ãƒ¼ã‚’é˜²æ­¢ã™ã‚‹ã“ã¨
 - `libs.versions.toml` ã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã™ã‚‹ï¼š
 
 ```toml
 [plugins]
-ksp = { id = "com.google.devtools.ksp", version = "2.0.0-1.0.20" }
+ksp = { id = "com.google.devtools.ksp", version = "2.0.20-1.0.21" }
 ```
 
 - `build.gradle.kts` å´ã§ã‚‚ä¸‹è¨˜ã®ã‚ˆã†ã«æŒ‡å®šï¼š
 
 ```kotlin
 plugins {
-    id("com.google.devtools.ksp") version "2.0.0-1.0.20"
+    id("com.google.devtools.ksp") version "2.0.20-1.0.21"
 }
 ```
 
 ---
 
 ## â˜‘ï¸ ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«é–¢é€£ãƒ«ãƒ¼ãƒ«ï¼ˆBuild Processorï¼‰
 
 - âœ… Roomã‚„Hiltãªã©ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å‡¦ç†ç³»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ **KSP ã®ã¿ä½¿ç”¨å¯**
 - âŒ `kapt(...)` ã®ä¾å­˜è¿½åŠ ã€ãŠã‚ˆã³ `id("kotlin.kapt")` ã®ä½¿ç”¨ã¯ç¦æ­¢
 - âœ… Kotlin 2.0 / Gradle 8 å¯¾å¿œã‚’å‰æã« KSP ã‚’åŸºæœ¬ã¨ã™ã‚‹
 - âœ… Room, Dagger, Hilt ãªã©ã¯ KSP å¯¾å¿œç‰ˆã«çµ±ä¸€
 - ğŸ§ª ãƒ“ãƒ«ãƒ‰ãƒ­ã‚°ä¸­ã« `kaptGenerateStubsDebugKotlin` ãŒå‡ºç¾ã—ãŸå ´åˆã€KAPTä¾å­˜ãŒæ®‹ã£ã¦ã„ã‚‹ãŸã‚å³æ™‚ä¿®æ­£
 
 ---
 
 ## âŒ ç¦æ­¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ»ç¦æ­¢äº‹é …
 
 - Material2 / AppCompat ç³» UI
 - Ktor / Apollo / Moshiï¼ˆæœªæ¡ç”¨ã®HTTP/JSONï¼‰
 - Microsoft OneDrive Android SDKï¼ˆéæ¨å¥¨ï¼‰
 - Guava ã®æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆlistenablefuture:1.0ãªã©ï¼‰
 - Coilã®æ··åœ¨ä½¿ç”¨ï¼ˆè¤‡æ•°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¦æ­¢ï¼‰
 - Composeé–¢é€£ã®éBOMæº–æ‹  UIãƒ©ã‚¤ãƒ–ãƒ©ãƒª
 
 ---
@@ -114,33 +114,33 @@ plugins {
 
 - Kotlin 1.9.21
 - Compose Compiler 1.5.7
 - KSP 1.0.15
 
 â†’ ã“ã‚Œã‚‰ã¯ç¾åœ¨éæ¨å¥¨ã§ã™ã€‚ç”ŸæˆAIãƒ»äººé–“å•ã‚ãšææ¡ˆã«ã¯ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚
 
 ---
 
 ## ğŸš¨ ç‰¹ã«æ³¨æ„ã™ã‚‹ãƒã‚¤ãƒ³ãƒˆ
 
 - **æ–°è¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å°å…¥ã¯ç¦æ­¢ï¼ˆä¸€è¦§ã®ä¸­ã§å®Ÿè£…ï¼‰**
 - **ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚«ã‚¿ãƒ­ã‚°ï¼ˆlibs.versions.tomlï¼‰ã«å®šç¾©ã•ã‚Œã¦ã„ãªã„ä¾å­˜ã¯ä½¿ã‚ãªã„**
 - **Kotlin, Compose, OkHttpãªã©ã¯å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³çµ±ä¸€å¿…é ˆ**
 
 ---
 
 ï¼ˆè‡ªå‹•ç”Ÿæˆæ—¥: 2025-06-30 / Kotlin 2.0å¯¾å¿œç‰ˆï¼‰
 
 
 
 ## ğŸ”§ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚«ã‚¿ãƒ­ã‚°ï¼ˆlibs.versions.tomlï¼‰ã§ã®KSPå®šç¾©
 
 ```toml
 [plugins]
-ksp = { id = "com.google.devtools.ksp", version = "2.0.0-1.0.20" }
+ksp = { id = "com.google.devtools.ksp", version = "2.0.20-1.0.21" }
 
 [libraries]
 ksp-api = { group = "com.google.devtools.ksp", name = "symbol-processing-api", version.ref = "ksp" }
 ```
 
 - `ksp` ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨ `symbol-processing-api` ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã€å¿…ãš toml ã«çµ±ä¸€ã—ã¦å®šç¾©ã™ã‚‹ã“ã¨  
 - `version.ref` ã«ã‚ˆã‚Šã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä¸€å…ƒç®¡ç†ã™ã‚‹
