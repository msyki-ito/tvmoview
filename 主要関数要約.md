主要なクラスや関数は次のとおりです。

プロジェクト構成
一部ですが、ディレクトリ構成は以下のようになっています

└── data/        APIクライアント・認証・DB関連
└── domain/      ドメインモデル
└── presentation/  Compose UI (components, screens, viewmodels)
└── tv/          TV向け最適化
└── ui/          共通テーマ
認証関連
AuthenticationManager: デバイスコードフローによる認証を実装。startDeviceCodeFlow でデバイスコード取得、pollForToken でトークン取得をポーリングし、取得したトークンは saveTokenResponse に保存する。
トークン取得・判定に getSavedToken, isAuthenticated, clearAuthentication などを提供。

データベース
MediaDatabaseProvider: Room を用いたローカルDBの初期化を行う。

MediaDao / FolderSyncDao: キャッシュアイテムやフォルダ同期情報の CRUD を担当。

CachedMediaItem / FolderSyncStatus: DBエンティティ定義。

ドメインモデル
MediaItem: ファイル／フォルダを表すモデル。拡張プロパティで isVideo, isImage, fileExtension, formattedSize を計算。

リポジトリ
MediaRepository: テスト用のダミーデータを提供。

OneDriveRepository: 認証済みトークンを用いて OneDrive API からアイテム取得・キャッシュを行う。getFolderItems, getDownloadUrl, sync 等を持つ。

ViewModel
MediaBrowserViewModel: アイテム一覧の取得・表示モード切替・ソート機能を管理する。loadItems, toggleViewMode, setSortBy, refresh を実装。

UIコンポーネント
ModernMediaCard, ModernListItem, ModernListView, ModernTileView, SortDialog, ModernTopBar, LoadingAnimation, EmptyStateView など。メディア表示や並び順設定、ローディング表示を行う。

画面 (Screens)
LoginScreen: デバイスコードを表示し認証を開始するUI。

ModernMediaBrowser: OneDrive上のメディアを一覧表示し、タイル／リスト表示の切替や並び替えを行う。

HighQualityPlayerScreen: ExoPlayer を使った動画再生画面。リモコン操作に対応し、シークバー表示や音量調整などを実装。

SettingsScreen: アプリ設定のUI。

AuthenticationWrapper: 認証状態に応じて LoginScreen かメイン画面を切り替える。

ナビゲーション
AppNavigation: Compose Navigation を定義し、ホーム、フォルダ、プレイヤー、設定画面へ遷移を行う。

メインエントリ
MainActivity: リポジトリや認証マネージャの初期化、AppNavigation 起動、OAuthリダイレクト処理を行う。

TV向け補助
FireTVOptimizations.initializeForFireTV: Fire TV 固有の最適化を行うためのプレースホルダー

テーマ
TVMovieTheme など Compose Material 3 ベースのカラースキームとタイポグラフィを定義

以上がリポジトリに含まれる主なクラスとその役割です。多くの機能が動画閲覧アプリを想定しており、OneDrive API との連携やExoPlayerによる再生、認証周りの実装などが特徴となっています。

さらに各クラスのプロパティ、関数、引数、リターンを一覧化、コメントを入れることを可能でしょうか？
コピーする
Summary

The repository is an Android TV application for browsing OneDrive media. It contains data access layers, view models, Compose UI, and a main activity. Key parts of the code and their members are outlined below.

Data Model
MediaItem represents files and folders with computed helpers (video/image check, file extension, formatted size)

Database Entities and Access
CachedMediaItem – entity for cached media items

FolderSyncStatus – stores last sync times for folders

MediaDatabase – Room database exposing mediaDao() and folderSyncDao()

MediaDatabaseProvider – singleton initializing the DB in init(context)

MediaDao provides queries to observe/modify cached items
FolderSyncDao tracks last sync timestamps

Authentication
AuthenticationManager handles the OAuth device-code flow. Main fields include clientId, tenantId, scope, prefs, and httpClient.
Important methods:

startDeviceCodeFlow() : DeviceCodeResponse – obtains device code info

pollForToken(deviceCode, interval) : TokenResponse – polls the token endpoint

getSavedToken(): AuthToken? and isAuthenticated() check stored credentials

clearAuthentication() wipes stored data

AuthToken holds access/refresh tokens with an isExpired property

Repositories
MediaRepository supplies in-memory test data and resolves folder paths. Methods include getRootItems(), getFolderItems(folderId), and getCurrentPath(folderId)

OneDriveRepository accesses OneDrive via Retrofit and caches data. Main members are authManager, mediaDao, folderSyncDao, and a Mutex for synchronization.
Key functions:

getCachedItems(folderId) returns cached items

getFolderItems(folderId, force) emits cached items and triggers sync() when needed

getDownloadUrl(itemId) retrieves the file’s download URL via HTTP

Private helpers getRootItemsResult(), getFolderItemsResult(), cacheItems(), and sync() handle API calls and caching

ViewModel
MediaBrowserViewModel stores UI state such as item list, view mode, and sort order. Public functions:

loadItems(folderId, force) fetches items (from OneDrive or test data)

toggleViewMode() switches between tile and list views

setSortBy(sortBy) changes sorting and applies it to current items

refresh() reloads data with forcing sync

Compose UI Components
ModernMediaCard, ModernListItem, ModernListView, ModernTileView, SortDialog, ModernTopBar, LoadingAnimation, and EmptyStateView render various parts of the UI. Each composable receives parameters like item: MediaItem or callbacks for user interaction (e.g., onItemClick, onSortSelected).
Example: ModernListView(items, onItemClick) creates a LazyColumn of ModernListItem components

Screens
LoginScreen manages the OAuth flow on TV. It displays device codes and polls for tokens using AuthenticationManager

ModernMediaBrowser shows media items and switches layouts/sorting via MediaBrowserViewModel

HighQualityPlayerScreen(itemId, onBack, downloadUrl) plays video with ExoPlayer and remote-control shortcuts

SettingsScreen(onBack) lists configurable options (autoplay, quality, dark mode, etc.)

Navigation and Main Activity
AppNavigation() defines routes for home, folder, player, and settings screens. It URL-encodes download URLs when navigating to the player screen

MainActivity initializes repositories, sets up the Compose theme, and calls AuthenticationWrapper() in onCreate

Other Utilities
FireTVOptimizations.initializeForFireTV(activity) is a placeholder for Fire TV–specific tweaks

TVMovieTheme defines color schemes and typography for the application theme